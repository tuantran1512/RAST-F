module Mod_Finalize


#ifdef siarhei_plot
      use Inc_Control,only:last_saved,current_sub,dummy_filler
#endif

implicit none

contains

subroutine Finalize_All

USE Inc_3D
USE Inc_Adjoint
USE Inc_Branch
USE Inc_CR
USE Inc_Crud
USE Inc_Depletion
USE Inc_Detector
USE Inc_DF
USE Inc_File
USE Inc_FixSrc_Tr
USE Inc_Geometry
USE Inc_History
USE Inc_INP
USE Inc_Kinetics
USE Inc_maXS
USE Inc_miXS
USE Inc_Nuclide
USE Inc_PinPOW
USE Inc_Pinvar
USE Inc_RP
USE Inc_RST
USE Inc_Solver
USE Inc_TH
USE Inc_Transient
USE Inc_Utile
USE Inc_XS_File
USE Inc_XYZ
use inc_fa

#ifdef js_mpi
use inc_parallel, only: comm
use mod_parallel, only: barrier
#endif

#ifdef siarhei_plot
      use Inc_Control,only:last_saved,current_sub
#endif

implicit none

#ifdef siarhei_plot
         ! @$^ siarhei_fr
         current_sub = &
            '^#^ Entered [Finalize_All] in Mod_Finalize'

#ifdef siarhei_plot
         ! @$^ siarhei_fr
         current_sub = &
            '+#+ Entered [Finalize_All] in Mod_Finalize'
         if(trim(last_saved).ne.trim(current_sub)) then
            write(678,'(A)') trim(current_sub)
            last_saved = current_sub
         end if
         ! =-=-=-=-=-=-=-=
#endif

         if(trim(last_saved).ne.trim(current_sub)) then
            write(678,'(A)') trim(current_sub)
            last_saved = current_sub
         end if
         ! =-=-=-=-=-=-=-=
#endif

#ifdef js_mpi
   if (comm%usempi) then
!      call barrier
            dummy_filler = 1 ! @$^ siarhei_plot 
   endif
#endif
   if(allocated(FisSrc)) deallocate(FisSrc)
   if(allocated(FisSrc_Old)) deallocate(FisSrc_Old)
   if(allocated(FisSrc_OOld)) deallocate(FisSrc_OOld)
   if(allocated(FisSrc_Iout)) deallocate(FisSrc_Iout)
   if(allocated(Power)) deallocate(Power)
   if(allocated(Normal_Power)) deallocate(Normal_Power)
   if(allocated(BU)) deallocate(BU)
   if(allocated(BU_Old)) deallocate(BU_Old)
   if(allocated(BU_Predictor)) deallocate(BU_Predictor)
   if(allocated(T_Fuel)) deallocate(T_Fuel)
   if(allocated(T_Fuel_Old_XSFB)) deallocate(T_Fuel_Old_XSFB)
   if(allocated(T_Mod)) deallocate(T_Mod)
   if(allocated(T_Mod_Old_XSFB)) deallocate(T_Mod_Old_XSFB)
   if(allocated(D_Mod)) deallocate(D_Mod)
   if(allocated(D_Mod_Old_XSFB)) deallocate(D_Mod_Old_XSFB)
   if(allocated(MTU)) deallocate(MTU)
   if(allocated(Flux)) deallocate(Flux)
   if(allocated(Flux_Old)) deallocate(Flux_Old)
   if(allocated(Flux_OOld)) deallocate(Flux_OOld)
   if(allocated(Flux_Old_XSFB)) deallocate(Flux_Old_XSFB)
   if(allocated(Flux_det_old)) deallocate(Flux_det_old)
   if(allocated(Flux_det)) deallocate(Flux_det)
   if(allocated(flux_adj)) deallocate(flux_adj)
   if(allocated(t_fuel_bk)) deallocate(t_fuel_bk)
   if(allocated(t_fuel_ss)) deallocate(t_fuel_ss)
   if(allocated(t_mod_bk)) deallocate(t_mod_bk)
   if(allocated(t_mod_ss)) deallocate(t_mod_ss)
   if(allocated(init_tFuel)) deallocate(init_tFuel)
   if(allocated(init_tMod)) deallocate(init_tMod)
   if(allocated(init_dMod)) deallocate(init_dMod)
   if(allocated(init_CR_Bot)) deallocate(init_CR_Bot)
   if(allocated(init_CR_Top)) deallocate(init_CR_Top)
   if(allocated(init_miXS_a_Xe35)) deallocate(init_miXS_a_Xe35)
   if(allocated(init_miXS_a_Sm49)) deallocate(init_miXS_a_Sm49)
   if(allocated(init_N_Xe35)) deallocate(init_N_Xe35)
   if(allocated(init_N_Sm49)) deallocate(init_N_Sm49)
   if(allocated(cr_bot_back)) deallocate(cr_bot_back)
   if(allocated(BU_back)) deallocate(BU_back)
   if(allocated(N_U34_back)) deallocate(N_U34_back)
   if(allocated(N_U35_back)) deallocate(N_U35_back)
   if(allocated(N_U36_back)) deallocate(N_U36_back)
   if(allocated(N_U37_back)) deallocate(N_U37_back)
   if(allocated(N_U38_back)) deallocate(N_U38_back)
   if(allocated(N_Np37_back)) deallocate(N_Np37_back)
   if(allocated(N_Np38_back)) deallocate(N_Np38_back)
   if(allocated(N_Np39_back)) deallocate(N_Np39_back)
   if(allocated(N_Pu38_back)) deallocate(N_Pu38_back)
   if(allocated(N_Pu39_back)) deallocate(N_Pu39_back)
   if(allocated(N_Pu40_back)) deallocate(N_Pu40_back)
   if(allocated(N_Pu41_back)) deallocate(N_Pu41_back)
   if(allocated(N_Pu42_back)) deallocate(N_Pu42_back)
   if(allocated(N_Pu43_back)) deallocate(N_Pu43_back)
   if(allocated(N_Am41_back)) deallocate(N_Am41_back)
   if(allocated(N_As42_back)) deallocate(N_As42_back)
   if(allocated(N_Am42_back)) deallocate(N_Am42_back)
   if(allocated(N_Am43_back)) deallocate(N_Am43_back)
   if(allocated(N_Am44_back)) deallocate(N_Am44_back)
   if(allocated(N_Cm42_back)) deallocate(N_Cm42_back)
   if(allocated(N_Cm43_back)) deallocate(N_Cm43_back)
   if(allocated(N_Cm44_back)) deallocate(N_Cm44_back)
   if(allocated(N_I35_back)) deallocate(N_I35_back)
   if(allocated(N_Xe35_back)) deallocate(N_Xe35_back)
   if(allocated(N_Nd47_back)) deallocate(N_Nd47_back)
   if(allocated(N_Nd48_back)) deallocate(N_Nd48_back)
   if(allocated(N_Nd49_back)) deallocate(N_Nd49_back)
   if(allocated(N_Pm47_back)) deallocate(N_Pm47_back)
   if(allocated(N_Ps48_back)) deallocate(N_Ps48_back)
   if(allocated(N_Pm48_back)) deallocate(N_Pm48_back)
   if(allocated(N_Pm49_back)) deallocate(N_Pm49_back)
   if(allocated(N_Sm47_back)) deallocate(N_Sm47_back)
   if(allocated(N_Sm48_back)) deallocate(N_Sm48_back)
   if(allocated(N_Sm49_back)) deallocate(N_Sm49_back)
   if(allocated(N_Gd52_back)) deallocate(N_Gd52_back)
   if(allocated(N_Gd54_back)) deallocate(N_Gd54_back)
   if(allocated(N_Gd55_back)) deallocate(N_Gd55_back)
   if(allocated(N_Gd56_back)) deallocate(N_Gd56_back)
   if(allocated(N_Gd57_back)) deallocate(N_Gd57_back)
   if(allocated(N_Gd58_back)) deallocate(N_Gd58_back)
   if(allocated(N_Gd60_back)) deallocate(N_Gd60_back)
   if(allocated(N_B0_back)) deallocate(N_B0_back)
   if(allocated(N_U34_old_back)) deallocate(N_U34_old_back)
   if(allocated(N_U35_old_back)) deallocate(N_U35_old_back)
   if(allocated(N_U36_old_back)) deallocate(N_U36_old_back)
   if(allocated(N_U37_old_back)) deallocate(N_U37_old_back)
   if(allocated(N_U38_old_back)) deallocate(N_U38_old_back)
   if(allocated(N_Np37_old_back)) deallocate(N_Np37_old_back)
   if(allocated(N_Np38_old_back)) deallocate(N_Np38_old_back)
   if(allocated(N_Np39_old_back)) deallocate(N_Np39_old_back)
   if(allocated(N_Pu38_old_back)) deallocate(N_Pu38_old_back)
   if(allocated(N_Pu39_old_back)) deallocate(N_Pu39_old_back)
   if(allocated(N_Pu40_old_back)) deallocate(N_Pu40_old_back)
   if(allocated(N_Pu41_old_back)) deallocate(N_Pu41_old_back)
   if(allocated(N_Pu42_old_back)) deallocate(N_Pu42_old_back)
   if(allocated(N_Pu43_old_back)) deallocate(N_Pu43_old_back)
   if(allocated(N_Am41_old_back)) deallocate(N_Am41_old_back)
   if(allocated(N_As42_old_back)) deallocate(N_As42_old_back)
   if(allocated(N_Am42_old_back)) deallocate(N_Am42_old_back)
   if(allocated(N_Am43_old_back)) deallocate(N_Am43_old_back)
   if(allocated(N_Am44_old_back)) deallocate(N_Am44_old_back)
   if(allocated(N_Cm42_old_back)) deallocate(N_Cm42_old_back)
   if(allocated(N_Cm43_old_back)) deallocate(N_Cm43_old_back)
   if(allocated(N_Cm44_old_back)) deallocate(N_Cm44_old_back)
   if(allocated(N_I35_old_back)) deallocate(N_I35_old_back)
   if(allocated(N_Xe35_old_back)) deallocate(N_Xe35_old_back)
   if(allocated(N_Nd47_old_back)) deallocate(N_Nd47_old_back)
   if(allocated(N_Nd48_old_back)) deallocate(N_Nd48_old_back)
   if(allocated(N_Nd49_old_back)) deallocate(N_Nd49_old_back)
   if(allocated(N_Pm47_old_back)) deallocate(N_Pm47_old_back)
   if(allocated(N_Ps48_old_back)) deallocate(N_Ps48_old_back)
   if(allocated(N_Pm48_old_back)) deallocate(N_Pm48_old_back)
   if(allocated(N_Pm49_old_back)) deallocate(N_Pm49_old_back)
   if(allocated(N_Sm47_old_back)) deallocate(N_Sm47_old_back)
   if(allocated(N_Sm48_old_back)) deallocate(N_Sm48_old_back)
   if(allocated(N_Sm49_old_back)) deallocate(N_Sm49_old_back)
   if(allocated(N_Gd52_old_back)) deallocate(N_Gd52_old_back)
   if(allocated(N_Gd54_old_back)) deallocate(N_Gd54_old_back)
   if(allocated(N_Gd55_old_back)) deallocate(N_Gd55_old_back)
   if(allocated(N_Gd56_old_back)) deallocate(N_Gd56_old_back)
   if(allocated(N_Gd57_old_back)) deallocate(N_Gd57_old_back)
   if(allocated(N_Gd58_old_back)) deallocate(N_Gd58_old_back)
   if(allocated(N_Gd60_old_back)) deallocate(N_Gd60_old_back)
   if(allocated(T_mod_back)) deallocate(T_mod_back)
   if(allocated(D_mod_back)) deallocate(D_mod_back)
   if(allocated(T_fuel_back)) deallocate(T_fuel_back)
   if(allocated(flux_back)) deallocate(flux_back)
   if(allocated(flux_old_back)) deallocate(flux_old_back)
   if(allocated(FisSrc_back)) deallocate(FisSrc_back)
   if(allocated(Power_back)) deallocate(Power_back)
   if(allocated(Normal_power_back)) deallocate(Normal_power_back)
!   if(allocated(if_step)) deallocate(if_step)   !branch
!   if(allocated(TF_Avg)) deallocate(TF_Avg)
!   if(allocated(TM_Avg)) deallocate(TM_Avg)
!   if(allocated(ppm_out)) deallocate(ppm_out)
   if(allocated(cr_bot)) deallocate(cr_bot)
   if(allocated(branch_case)) deallocate(branch_case)
!   if(allocated(save_tfuel)) deallocate(save_tfuel)
   if(allocated(Length_CR)) deallocate(Length_CR)
   if(allocated(Length_CR_Tip)) deallocate(Length_CR_Tip)
   if(allocated(CR_Bot)) deallocate(CR_Bot)
   if(allocated(CR_Top)) deallocate(CR_Top)
   if(allocated(dCR_MoveCR)) deallocate(dCR_MoveCR)
   if(allocated(v_MoveCR)) deallocate(v_MoveCR)
   if(allocated(PDIL)) deallocate(PDIL)
   if(allocated(PDWL)) deallocate(PDWL)
   if(allocated(Reg_VF)) deallocate(Reg_VF)
   if(allocated(MoveCR_Bot)) deallocate(MoveCR_Bot)
   if(allocated(T_MoveCR)) deallocate(T_MoveCR)
!+>> hj.. Refer Mod_GetNode.f90
   if(allocated(I_CR_1N)) deallocate(I_CR_1N)
   if(allocated(I_CR_4N)) deallocate(I_CR_4N)
   if(allocated(Comp_CR)) deallocate(Comp_CR)
#ifdef tuan_tr_test   

#else
   if(allocated(N_MoveCR)) deallocate(N_MoveCR)

#endif
   
   if(allocated(I_MoveCR)) deallocate(I_MoveCR)
   if(allocated(Name_CR)) deallocate(Name_CR)
   if(allocated(Flag_Move)) deallocate(Flag_Move)
   if(allocated(CR_mat_frac)) deallocate(CR_mat_frac)
   if(allocated(NB0_Table)) deallocate(NB0_Table)
   if(allocated(N_crudb0)) deallocate(N_crudb0)
   if(allocated(n_crudb0_old)) deallocate(n_crudb0_old)
   if(allocated(Hist_n_crudb0)) deallocate(Hist_n_crudb0)
   if(allocated(hist_n_crudb0_z)) deallocate(hist_n_crudb0_z)
   if(allocated(day_boa)) deallocate(day_boa)
   if(allocated(Boa_b0)) deallocate(Boa_b0)
   if(allocated(Boa_dr)) deallocate(Boa_dr)
   if(allocated(z_boa)) deallocate(z_boa)
   if(allocated(Crud_table)) deallocate(Crud_table)
   if(allocated(Cruddr_table)) deallocate(Cruddr_table)
   if(allocated(FAASI_INP)) deallocate(FAASI_INP)
   if(allocated(itr_FA_BD)) deallocate(itr_FA_BD)
   if(allocated(itr_FA_ASI)) deallocate(itr_FA_ASI)
   if(allocated(slope_FA_BD)) deallocate(slope_FA_BD)
   if(allocated(cruddr)) deallocate(cruddr)
   if(allocated(cruddr_old)) deallocate(cruddr_old)
   if(allocated(cruddtf)) deallocate(cruddtf)
   if(allocated(TD_crud_bnden)) deallocate(TD_crud_bnden)
   if(allocated(TD_crud_drf)) deallocate(TD_crud_drf)
   if(allocated(TD_crud_ASI)) deallocate(TD_crud_ASI)
   if(allocated(IF_ASI_search)) deallocate(IF_ASI_search)
   if(allocated(B0_RRa)) deallocate(B0_RRa)
   if(allocated(total_Crud)) deallocate(total_Crud)
   if(allocated(Ind_BU)) deallocate(Ind_BU)
   if(allocated(Ind_BU_Predictor)) deallocate(Ind_BU_Predictor)
   if(allocated(Cycle_BU)) deallocate(Cycle_BU)
   if(allocated(MRST_BU)) deallocate(MRST_BU)
   if(allocated(alpha)) deallocate(alpha)
   if(allocated(theta)) deallocate(theta)
   if(allocated(Mat_I_HN)) deallocate(Mat_I_HN)
   if(allocated(Mat_I_FP)) deallocate(Mat_I_FP)
   if(allocated(Flag_Ada_FA)) deallocate(Flag_Ada_FA)
   if(allocated(ID_SubBatch)) deallocate(ID_SubBatch)
   if(allocated(N_FA_LP)) deallocate(N_FA_LP)
   if(allocated(MB_SubBatch)) deallocate(MB_SubBatch)
   if(allocated(ID_BU_A)) deallocate(ID_BU_A)
   if(allocated(Flag_Ada_BU_Step)) deallocate(Flag_Ada_BU_Step)
   if(allocated(Power_1N_Ref)) deallocate(Power_1N_Ref)
   if(allocated(cycle_day)) deallocate(cycle_day)
   !js+if(allocated(DET_ZA)) deallocate(DET_ZA)
   if(allocated(DET_Reaction)) deallocate(DET_Reaction)
   if(allocated(DET_flux_ratio_base)) deallocate(DET_flux_ratio_base)
   if(allocated(DET_flux_ratio)) deallocate(DET_flux_ratio)
   if(allocated(DET_XS_base)) deallocate(DET_XS_base)
   if(allocated(DET_XS)) deallocate(DET_XS)
   if(allocated(DRF)) deallocate(DRF)
   if(allocated(DR)) deallocate(DR)
   if(allocated(x_kal)) deallocate(x_kal)
   if(allocated(xg_kal)) deallocate(xg_kal)
   if(allocated(xgm_kal)) deallocate(xgm_kal)
   if(allocated(I_beta_av_temp)) deallocate(I_beta_av_temp)
   if(allocated(DET_flux_av_temp)) deallocate(DET_flux_av_temp)
   if(allocated(temp_flux)) deallocate(temp_flux)
   if(allocated(temp_flux_r)) deallocate(temp_flux_r)
   if(allocated(P)) deallocate(P)
   if(allocated(Pm)) deallocate(Pm)
   if(allocated(KN)) deallocate(KN)
   if(allocated(xm_FKH)) deallocate(xm_FKH)
   if(allocated(y_FKH)) deallocate(y_FKH)
   if(allocated(kesi_FKH)) deallocate(kesi_FKH)
   if(allocated(X2m)) deallocate(X2m)
   if(allocated(X2m_rh)) deallocate(X2m_rh)
   if(allocated(KN_rh)) deallocate(KN_rh)
   if(allocated(Pm_rh)) deallocate(Pm_rh)
   if(allocated(xg)) deallocate(xg)
   if(allocated(xgm)) deallocate(xgm)
   if(allocated(P_rh)) deallocate(P_rh)
   if(allocated(DET_P_XY)) deallocate(DET_P_XY)
   if(allocated(DET_P_Axial)) deallocate(DET_P_Axial)
   if(allocated(DET_RF_array)) deallocate(DET_RF_array)
   if(allocated(dam2)) deallocate(dam2)
   if(allocated(DET_1N)) deallocate(DET_1N)
   if(allocated(DET_Y)) deallocate(DET_Y)
   if(allocated(det_z_beg)) deallocate(det_z_beg)
   if(allocated(det_z_end)) deallocate(det_z_end)
   if(allocated(DET_FRSET)) deallocate(DET_FRSET)
   if(allocated(DET_FR)) deallocate(DET_FR)
   if(allocated(DET_SIG_PHI)) deallocate(DET_SIG_PHI)
   if(allocated(DET_SIG_PHI_G)) deallocate(DET_SIG_PHI_G)
   if(allocated(DET_SIG_PHI_G_Old)) deallocate(DET_SIG_PHI_G_Old)
   if(allocated(DET_Flux_XYZ_G)) deallocate(DET_Flux_XYZ_G)
   if(allocated(DET_Flux_XYZ_G_Old)) deallocate(DET_Flux_XYZ_G_Old)
   if(allocated(DET_I_FA)) deallocate(DET_I_FA)
   if(allocated(DET_XY_LIST)) deallocate(DET_XY_LIST)
   if(allocated(det_z_start_end)) deallocate(det_z_start_end)
   if(allocated(det_h_start_end)) deallocate(det_h_start_end)
   if(allocated(DET_mixsset)) deallocate(DET_mixsset)
   if(allocated(DET_mixs)) deallocate(DET_mixs)
   if(allocated(det_sig_rr)) deallocate(det_sig_rr)
   if(allocated(det_rr_xyz)) deallocate(det_rr_xyz)
   if(allocated(det_power_xyz)) deallocate(det_power_xyz)
   if(allocated(det_detpow)) deallocate(det_detpow)
   if(allocated(det_wprime)) deallocate(det_wprime)
   if(allocated(drf_core)) deallocate(drf_core)
   if(allocated(dr_core)) deallocate(dr_core)
   if(allocated(ADF_Lx)) deallocate(ADF_Lx)
   if(allocated(ADF_Rx)) deallocate(ADF_Rx)
   if(allocated(ADF_Ly)) deallocate(ADF_Ly)
   if(allocated(ADF_Ry)) deallocate(ADF_Ry)
   if(allocated(ADF_Lz)) deallocate(ADF_Lz)
   if(allocated(ADF_Rz)) deallocate(ADF_Rz)
   if(allocated(ADF_Avg)) deallocate(ADF_Avg)
   if(allocated(Buff_ADF_Lx)) deallocate(Buff_ADF_Lx)
   if(allocated(Buff_ADF_Rx)) deallocate(Buff_ADF_Rx)
   if(allocated(Buff_ADF_Ly)) deallocate(Buff_ADF_Ly)
   if(allocated(Buff_ADF_Ry)) deallocate(Buff_ADF_Ry)
   if(allocated(CDF_LxLy)) deallocate(CDF_LxLy)
   if(allocated(CDF_LxRy)) deallocate(CDF_LxRy)
   if(allocated(CDF_RxLy)) deallocate(CDF_RxLy)
   if(allocated(CDF_RxRy)) deallocate(CDF_RxRy)

   if(allocated(Name_MRI)) deallocate(Name_MRI)
   if(allocated(Cycle_MRI)) deallocate(Cycle_MRI)
   if(allocated(axial_cont)) deallocate(axial_cont)
   if(allocated(flag_out_print)) deallocate(flag_out_print)
   if(allocated(R_MRI)) deallocate(R_MRI)
   if(allocated(rvdtvol)) deallocate(rvdtvol)
   if(allocated(rvdtdvol)) deallocate(rvdtdvol)
   if(allocated(rldt)) deallocate(rldt)
   if(allocated(rldtgp1)) deallocate(rldtgp1)
   if(allocated(cappap1)) deallocate(cappap1)
   if(allocated(capbrldt)) deallocate(capbrldt)
   if(allocated(capbrldt2)) deallocate(capbrldt2)

   if(allocated(ixytoix)) deallocate(ixytoix)
   if(allocated(ixytoiy)) deallocate(ixytoiy)
   if(allocated(h_x)) deallocate(h_x)
!   if(allocated(h_y)) deallocate(h_y)
   if(allocated(h_z)) deallocate(h_z)
   if(allocated(GridSize_x)) deallocate(GridSize_x)
   if(allocated(GridSize_y)) deallocate(GridSize_y)
   if(allocated(GridSize_z)) deallocate(GridSize_z)
   if(allocated(MeshSize_x)) deallocate(MeshSize_x)
   if(allocated(MeshSize_y)) deallocate(MeshSize_y)
   if(allocated(MeshSize_z)) deallocate(MeshSize_z)
   if(allocated(Nx_y_1N)) deallocate(Nx_y_1N)
   if(allocated(Mesh_x)) deallocate(Mesh_x)
   if(allocated(Mesh_y)) deallocate(Mesh_y)
   if(allocated(Mesh_z)) deallocate(Mesh_z)
   if(allocated(NodeVolume)) deallocate(NodeVolume)
   if(allocated(Nx_y)) deallocate(Nx_y)
   if(allocated(N_ID)) deallocate(N_ID)
   if(allocated(Ixy_Start_y)) deallocate(Ixy_Start_y)
   if(allocated(Ixy_End_y)) deallocate(Ixy_End_y)
   if(allocated(I_Lx)) deallocate(I_Lx)
   if(allocated(I_Rx)) deallocate(I_Rx)
   if(allocated(I_Ly)) deallocate(I_Ly)
   if(allocated(I_Ry)) deallocate(I_Ry)
   if(allocated(I_Rz)) deallocate(I_Rz)
   if(allocated(I_Lz)) deallocate(I_Lz)
   if(allocated(I_4Nto1N)) deallocate(I_4Nto1N)
   if(allocated(Ix_4Nto1N)) deallocate(Ix_4Nto1N)
   if(allocated(Iy_4Nto1N)) deallocate(Iy_4Nto1N)
   if(allocated(Ix_Start_y_1N)) deallocate(Ix_Start_y_1N)
!   if(allocated(Ix_End_y_1N)) deallocate(Ix_End_y_1N)
   if(allocated(Ix_StartFA_y_1N)) deallocate(Ix_StartFA_y_1N)
   if(allocated(Ix_EndFA_y_1N)) deallocate(Ix_EndFA_y_1N)
   if(allocated(Iy_Start_x_1N)) deallocate(Iy_Start_x_1N)
   if(allocated(Iy_End_x_1N)) deallocate(Iy_End_x_1N)
   if(allocated(Iy_StartFA_x_1N)) deallocate(Iy_StartFA_x_1N)
   if(allocated(Iy_EndFA_x_1N)) deallocate(Iy_EndFA_x_1N)
   if(allocated(Ix_Start_y)) deallocate(Ix_Start_y)
   if(allocated(Ix_End_y)) deallocate(Ix_End_y)
   if(allocated(Iy_Start_x)) deallocate(Iy_Start_x)
   if(allocated(Iy_End_x)) deallocate(Iy_End_x)
   if(allocated(IxToIx_1N)) deallocate(IxToIx_1N)
   if(allocated(IyToIy_1N)) deallocate(IyToIy_1N)
   if(allocated(I_4Nin1FA)) deallocate(I_4Nin1FA)
   if(allocated(I_1Nto4N)) deallocate(I_1Nto4N)
   if(allocated(IxIyToIxy)) deallocate(IxIyToIxy)
   if(allocated(IxIyToIxy_1N)) deallocate(IxIyToIxy_1N)
   if(allocated(IxIy_1NToIxy)) deallocate(IxIy_1NToIxy)
   if(allocated(IxIy_1NToIxy_1N)) deallocate(IxIy_1NToIxy_1N)
   if(allocated(x_fa_index)) deallocate(x_fa_index)
   if(allocated(y_fa_index)) deallocate(y_fa_index)
   if(allocated(xy_fa_index)) deallocate(xy_fa_index)
   if(allocated(xy_fa_index_org)) deallocate(xy_fa_index_org)
   if(allocated(x_fa_findex)) deallocate(x_fa_findex)
   if(allocated(y_fa_findex)) deallocate(y_fa_findex)
   if(allocated(xy_fa_findex)) deallocate(xy_fa_findex)
   if(allocated(xy_fa_findex_org)) deallocate(xy_fa_findex_org)
   if(allocated(I_Lx_P2R)) deallocate(I_Lx_P2R)
   if(allocated(I_Rx_P2R)) deallocate(I_Rx_P2R)
   if(allocated(I_Ly_P2R)) deallocate(I_Ly_P2R)
   if(allocated(I_Ry_P2R)) deallocate(I_Ry_P2R)
   if(allocated(nodelfa)) deallocate(nodelfa)
   if(allocated(nrnx)) deallocate(nrnx)
   if(allocated(ltola)) deallocate(ltola)
   if(allocated(latol)) deallocate(latol)
   if(allocated(ltox)) deallocate(ltox)
   if(allocated(ltoy)) deallocate(ltoy)
   if(allocated(ltolf)) deallocate(ltolf)
   if(allocated(ltolfa)) deallocate(ltolfa)
   if(allocated(lfatol)) deallocate(lfatol)
   if(allocated(lfaptr)) deallocate(lfaptr)
   if(allocated(nodel)) deallocate(nodel)
   if(allocated(nodef)) deallocate(nodef)
   if(allocated(znode)) deallocate(znode)
   if(allocated(zcent)) deallocate(zcent)
   if(allocated(zb)) deallocate(zb)
   if(allocated(Hist_Sec)) deallocate(Hist_Sec)
   if(allocated(Hist_Hour)) deallocate(Hist_Hour)
   if(allocated(Hist_Day)) deallocate(Hist_Day)
   if(allocated(Hist_Time)) deallocate(Hist_Time)
   if(allocated(Hist_Cycle_BU)) deallocate(Hist_Cycle_BU)
   if(allocated(Hist_Accum_BU)) deallocate(Hist_Accum_BU)
   if(allocated(Hist_PPower)) deallocate(Hist_PPower)
   if(allocated(Hist_PPM)) deallocate(Hist_PPM)
   if(allocated(Hist_keff)) deallocate(Hist_keff)
   if(allocated(Hist_Reactivity)) deallocate(Hist_Reactivity)
   if(allocated(hist_tmm_inp)) deallocate(hist_tmm_inp)
   if(allocated(Hist_ADJPPM)) deallocate(Hist_ADJPPM)
   if(allocated(Hist_PPMB10)) deallocate(Hist_PPMB10)
   if(allocated(Hist_B10DEP)) deallocate(Hist_B10DEP)
   if(allocated(Hist_ASI)) deallocate(Hist_ASI)
   if(allocated(Hist_PF_1D)) deallocate(Hist_PF_1D)
   if(allocated(Hist_PF_2D)) deallocate(Hist_PF_2D)
   if(allocated(Hist_PF_3D)) deallocate(Hist_PF_3D)
   if(allocated(Hist_PBU_FA)) deallocate(Hist_PBU_FA)
   if(allocated(Hist_PBU_Pin)) deallocate(Hist_PBU_Pin)
   if(allocated(Hist_Fxy)) deallocate(Hist_Fxy)
   if(allocated(Hist_Fq)) deallocate(Hist_Fq)
   if(allocated(Hist_Fr)) deallocate(Hist_Fr)
   if(allocated(Hist_Fq_val)) deallocate(Hist_Fq_val)
   if(allocated(Hist_Fr_val)) deallocate(Hist_Fr_val)
   if(allocated(Hist_Fz_val)) deallocate(Hist_Fz_val)
   if(allocated(Hist_FdH_val)) deallocate(Hist_FdH_val)
   if(allocated(Hist_max_Fxy_val)) deallocate(Hist_max_Fxy_val)
   if(allocated(Hist_Fq_loc)) deallocate(Hist_Fq_loc)
   if(allocated(Hist_Fr_loc)) deallocate(Hist_Fr_loc)
   if(allocated(Hist_Fz_loc)) deallocate(Hist_Fz_loc)
   if(allocated(Hist_FdH_loc)) deallocate(Hist_FdH_loc)
   if(allocated(Hist_max_Fxy_loc)) deallocate(Hist_max_Fxy_loc)
   if(allocated(Hist_maxPBU_2D)) deallocate(Hist_maxPBU_2D)
   if(allocated(Hist_maxPPD_2D)) deallocate(Hist_maxPPD_2D)
   if(allocated(Hist_maxPPD_3D)) deallocate(Hist_maxPPD_3D)
   if(allocated(Hist_maxPPW_2D)) deallocate(Hist_maxPPW_2D)
   if(allocated(Hist_maxPPW_3D)) deallocate(Hist_maxPPW_3D)
   if(allocated(Hist_PBU_2D_loc)) deallocate(Hist_PBU_2D_loc)
   if(allocated(Hist_PPD_2D_loc)) deallocate(Hist_PPD_2D_loc)
   if(allocated(Hist_PPD_3D_loc)) deallocate(Hist_PPD_3D_loc)
   if(allocated(Hist_PPW_2D_loc)) deallocate(Hist_PPW_2D_loc)
   if(allocated(Hist_PPW_3D_loc)) deallocate(Hist_PPW_3D_loc)
   if(allocated(Hist_PP_1D)) deallocate(Hist_PP_1D)
   if(allocated(Hist_PP_2D)) deallocate(Hist_PP_2D)
   if(allocated(Hist_PP_3D)) deallocate(Hist_PP_3D)
   if(allocated(Hist_PPBU_FA)) deallocate(Hist_PPBU_FA)
   if(allocated(Hist_PPBU_Pin)) deallocate(Hist_PPBU_Pin)
   if(allocated(Hist_CR)) deallocate(Hist_CR)
   if(allocated(Hist_TF_Avg)) deallocate(Hist_TF_Avg)
   if(allocated(Hist_TF_Max)) deallocate(Hist_TF_Max)
   if(allocated(Hist_TF_Min)) deallocate(Hist_TF_Min)
   if(allocated(Hist_TM_Avg)) deallocate(Hist_TM_Avg)
   if(allocated(Hist_TM_Max)) deallocate(Hist_TM_Max)
   if(allocated(Hist_TM_Min)) deallocate(Hist_TM_Min)
   if(allocated(Hist_TM_In)) deallocate(Hist_TM_In)
   if(allocated(Hist_TM_Out)) deallocate(Hist_TM_Out)
   if(allocated(Hist_DM_Avg)) deallocate(Hist_DM_Avg)
   if(allocated(Hist_DM_Max)) deallocate(Hist_DM_Max)
   if(allocated(Hist_DM_Min)) deallocate(Hist_DM_Min)
   if(allocated(Hist_TFcen_Max)) deallocate(Hist_TFcen_Max)
   if(allocated(Hist_Xe35)) deallocate(Hist_Xe35)
   if(allocated(Hist_Xe35_ASI)) deallocate(Hist_Xe35_ASI)
   if(allocated(Hist_Sm49)) deallocate(Hist_Sm49)
   if(allocated(Hist_Sm49_ASI)) deallocate(Hist_Sm49_ASI)
   if(allocated(Hist_I35)) deallocate(Hist_I35)
   if(allocated(Hist_Nd47)) deallocate(Hist_Nd47)
   if(allocated(Hist_Nd48)) deallocate(Hist_Nd48)
   if(allocated(Hist_Nd49)) deallocate(Hist_Nd49)
   if(allocated(Hist_Pm47)) deallocate(Hist_Pm47)
   if(allocated(Hist_Ps48)) deallocate(Hist_Ps48)
   if(allocated(Hist_Pm48)) deallocate(Hist_Pm48)
   if(allocated(Hist_Pm49)) deallocate(Hist_Pm49)
   if(allocated(Hist_Sm47)) deallocate(Hist_Sm47)
   if(allocated(Hist_Sm48)) deallocate(Hist_Sm48)
   if(allocated(Hist_Gd52)) deallocate(Hist_Gd52)
   if(allocated(Hist_Gd54)) deallocate(Hist_Gd54)
   if(allocated(Hist_Gd55)) deallocate(Hist_Gd55)
   if(allocated(Hist_Gd56)) deallocate(Hist_Gd56)
   if(allocated(Hist_Gd57)) deallocate(Hist_Gd57)
   if(allocated(Hist_Gd58)) deallocate(Hist_Gd58)
   if(allocated(Hist_Gd60)) deallocate(Hist_Gd60)
   if(allocated(Hist_U34)) deallocate(Hist_U34)
   if(allocated(Hist_U35)) deallocate(Hist_U35)
   if(allocated(Hist_U36)) deallocate(Hist_U36)
   if(allocated(Hist_U37)) deallocate(Hist_U37)
   if(allocated(Hist_U38)) deallocate(Hist_U38)
   if(allocated(Hist_Np37)) deallocate(Hist_Np37)
   if(allocated(Hist_Np38)) deallocate(Hist_Np38)
   if(allocated(Hist_Np39)) deallocate(Hist_Np39)
   if(allocated(Hist_Pu38)) deallocate(Hist_Pu38)
   if(allocated(Hist_Pu39)) deallocate(Hist_Pu39)
   if(allocated(Hist_Pu40)) deallocate(Hist_Pu40)
   if(allocated(Hist_Pu41)) deallocate(Hist_Pu41)
   if(allocated(Hist_Pu42)) deallocate(Hist_Pu42)
   if(allocated(Hist_Pu43)) deallocate(Hist_Pu43)
   if(allocated(Hist_Am41)) deallocate(Hist_Am41)
   if(allocated(Hist_As42)) deallocate(Hist_As42)
   if(allocated(Hist_Am42)) deallocate(Hist_Am42)
   if(allocated(Hist_Am43)) deallocate(Hist_Am43)
   if(allocated(Hist_Am44)) deallocate(Hist_Am44)
   if(allocated(Hist_Cm42)) deallocate(Hist_Cm42)
   if(allocated(Hist_Cm43)) deallocate(Hist_Cm43)
   if(allocated(Hist_Cm44)) deallocate(Hist_Cm44)
   if(allocated(Hist_Normal_Power_Z)) deallocate(Hist_Normal_Power_Z)
   if(allocated(Hist_Normal_Power_XY)) deallocate(Hist_Normal_Power_XY)
   if(allocated(Hist_Normal_Power_XYZ)) deallocate(Hist_Normal_Power_XYZ)
   if(allocated(Hist_BU_Z)) deallocate(Hist_BU_Z)
   if(allocated(Hist_BU_XY)) deallocate(Hist_BU_XY)
   if(allocated(Hist_BU_XYZ)) deallocate(Hist_BU_XYZ)
   if(allocated(Hist_T_Fuel_Z)) deallocate(Hist_T_Fuel_Z)
   if(allocated(Hist_T_Mod_Z)) deallocate(Hist_T_Mod_Z)
   if(allocated(Hist_D_Mod_Z)) deallocate(Hist_D_Mod_Z)
   if(allocated(Hist_T_Fuel_XY)) deallocate(Hist_T_Fuel_XY)
   if(allocated(Hist_T_Mod_XY)) deallocate(Hist_T_Mod_XY)
   if(allocated(Hist_D_Mod_XY)) deallocate(Hist_D_Mod_XY)
   if(allocated(Hist_T_Fuel_XYZ)) deallocate(Hist_T_Fuel_XYZ)
   if(allocated(Hist_T_Mod_XYZ)) deallocate(Hist_T_Mod_XYZ)
   if(allocated(Hist_D_Mod_XYZ)) deallocate(Hist_D_Mod_XYZ)
   if(allocated(Hist_N_Xe35_XYZ)) deallocate(Hist_N_Xe35_XYZ)
   if(allocated(Hist_N_Sm49_XYZ)) deallocate(Hist_N_Sm49_XYZ)
   if(allocated(Hist_FFlux_XYZ)) deallocate(Hist_FFlux_XYZ)
   if(allocated(Hist_TFlux_XYZ)) deallocate(Hist_TFlux_XYZ)
   if(allocated(Hist_Normal_Power_XYZ_4N)) deallocate(Hist_Normal_Power_XYZ_4N)
   if(allocated(Hist_BU_XYZ_4N)) deallocate(Hist_BU_XYZ_4N)
   if(allocated(Hist_T_Fuel_XYZ_4N)) deallocate(Hist_T_Fuel_XYZ_4N)
   if(allocated(Hist_T_Mod_XYZ_4N)) deallocate(Hist_T_Mod_XYZ_4N)
   if(allocated(Hist_N_Xe35_XYZ_4N)) deallocate(Hist_N_Xe35_XYZ_4N)
   if(allocated(Hist_N_Sm49_XYZ_4N)) deallocate(Hist_N_Sm49_XYZ_4N)
   if(allocated(Hist_FFlux_XYZ_4N)) deallocate(Hist_FFlux_XYZ_4N)
   if(allocated(Hist_TFlux_XYZ_4N)) deallocate(Hist_TFlux_XYZ_4N)
   if(allocated(Hist_Normal_Power_XY_4N)) deallocate(Hist_Normal_Power_XY_4N)
   if(allocated(Hist_BU_XY_4N)) deallocate(Hist_BU_XY_4N)
   if(allocated(Hist_crud_nden_Z)) deallocate(Hist_crud_nden_Z)
   if(allocated(Hist_cruddr_Z)) deallocate(Hist_cruddr_Z)
   if(allocated(Hist_cruddtf_Z)) deallocate(Hist_cruddtf_Z)
   if(allocated(Hist_crud_nden_XY)) deallocate(Hist_crud_nden_XY)
   if(allocated(Hist_cruddr_XY)) deallocate(Hist_cruddr_XY)
   if(allocated(Hist_cruddtf_XY)) deallocate(Hist_cruddtf_XY)
   if(allocated(Hist_crud_nden_XYZ)) deallocate(Hist_crud_nden_XYZ)
   if(allocated(Hist_cruddr_XYZ)) deallocate(Hist_cruddr_XYZ)
   if(allocated(Hist_cruddtf_XYZ)) deallocate(Hist_cruddtf_XYZ)
   if(allocated(Hist_FA_ASI)) deallocate(Hist_FA_ASI)
   if(allocated(Hist_FTC)) deallocate(Hist_FTC)
   if(allocated(Hist_MTC)) deallocate(Hist_MTC)
   if(allocated(Hist_ITC)) deallocate(Hist_ITC)
   if(allocated(Hist_CRW)) deallocate(Hist_CRW)
   if(allocated(Hist_XEW)) deallocate(Hist_XEW)
   if(allocated(Hist_SMW)) deallocate(Hist_SMW)
   if(allocated(Hist_GDW)) deallocate(Hist_GDW)
   if(allocated(Hist_Power)) deallocate(Hist_Power)
   if(allocated(Hist_Burnup)) deallocate(Hist_Burnup)
   if(allocated(Hist_T_Fuel)) deallocate(Hist_T_Fuel)
   if(allocated(Hist_T_Mod)) deallocate(Hist_T_Mod)
   if(allocated(Hist_D_Mod)) deallocate(Hist_D_Mod)
   if(allocated(Hist_N_I35)) deallocate(Hist_N_I35)
   if(allocated(Hist_N_Xe35)) deallocate(Hist_N_Xe35)
   if(allocated(Hist_N_Nd47)) deallocate(Hist_N_Nd47)
   if(allocated(Hist_N_Nd48)) deallocate(Hist_N_Nd48)
   if(allocated(Hist_N_Nd49)) deallocate(Hist_N_Nd49)
   if(allocated(Hist_N_Pm47)) deallocate(Hist_N_Pm47)
   if(allocated(Hist_N_Ps48)) deallocate(Hist_N_Ps48)
   if(allocated(Hist_N_Pm48)) deallocate(Hist_N_Pm48)
   if(allocated(Hist_N_Pm49)) deallocate(Hist_N_Pm49)
   if(allocated(Hist_N_Sm47)) deallocate(Hist_N_Sm47)
   if(allocated(Hist_N_Sm48)) deallocate(Hist_N_Sm48)
   if(allocated(Hist_N_Sm49)) deallocate(Hist_N_Sm49)
   if(allocated(Hist_N_Gd52)) deallocate(Hist_N_Gd52)
   if(allocated(Hist_N_Gd54)) deallocate(Hist_N_Gd54)
   if(allocated(Hist_N_Gd55)) deallocate(Hist_N_Gd55)
   if(allocated(Hist_N_Gd56)) deallocate(Hist_N_Gd56)
   if(allocated(Hist_N_Gd57)) deallocate(Hist_N_Gd57)
   if(allocated(Hist_N_Gd58)) deallocate(Hist_N_Gd58)
   if(allocated(Hist_N_Gd60)) deallocate(Hist_N_Gd60)
   if(allocated(Hist_N_U34)) deallocate(Hist_N_U34)
   if(allocated(Hist_N_U35)) deallocate(Hist_N_U35)
   if(allocated(Hist_N_U36)) deallocate(Hist_N_U36)
   if(allocated(Hist_N_U37)) deallocate(Hist_N_U37)
   if(allocated(Hist_N_U38)) deallocate(Hist_N_U38)
   if(allocated(Hist_N_Np37)) deallocate(Hist_N_Np37)
   if(allocated(Hist_N_Np38)) deallocate(Hist_N_Np38)
   if(allocated(Hist_N_Np39)) deallocate(Hist_N_Np39)
   if(allocated(Hist_N_Pu38)) deallocate(Hist_N_Pu38)
   if(allocated(Hist_N_Pu39)) deallocate(Hist_N_Pu39)
   if(allocated(Hist_N_Pu40)) deallocate(Hist_N_Pu40)
   if(allocated(Hist_N_Pu41)) deallocate(Hist_N_Pu41)
   if(allocated(Hist_N_Pu42)) deallocate(Hist_N_Pu42)
   if(allocated(Hist_N_Pu43)) deallocate(Hist_N_Pu43)
   if(allocated(Hist_N_Am41)) deallocate(Hist_N_Am41)
   if(allocated(Hist_N_As42)) deallocate(Hist_N_As42)
   if(allocated(Hist_N_Am42)) deallocate(Hist_N_Am42)
   if(allocated(Hist_N_Am43)) deallocate(Hist_N_Am43)
   if(allocated(Hist_N_Am44)) deallocate(Hist_N_Am44)
   if(allocated(Hist_N_Cm42)) deallocate(Hist_N_Cm42)
   if(allocated(Hist_N_Cm43)) deallocate(Hist_N_Cm43)
   if(allocated(Hist_N_Cm44)) deallocate(Hist_N_Cm44)
   if(allocated(Hist_Power_FA)) deallocate(Hist_Power_FA)
   if(allocated(Hist_Burnup_FA)) deallocate(Hist_Burnup_FA)
   if(allocated(Hist_T_Fuel_FA)) deallocate(Hist_T_Fuel_FA)
   if(allocated(Hist_T_Mod_FA)) deallocate(Hist_T_Mod_FA)
   if(allocated(Hist_D_Mod_FA)) deallocate(Hist_D_Mod_FA)
   if(allocated(Hist_N_I35_FA)) deallocate(Hist_N_I35_FA)
   if(allocated(Hist_N_Xe35_FA)) deallocate(Hist_N_Xe35_FA)
   if(allocated(Hist_N_Nd47_FA)) deallocate(Hist_N_Nd47_FA)
   if(allocated(Hist_N_Nd48_FA)) deallocate(Hist_N_Nd48_FA)
   if(allocated(Hist_N_Nd49_FA)) deallocate(Hist_N_Nd49_FA)
   if(allocated(Hist_N_Pm47_FA)) deallocate(Hist_N_Pm47_FA)
   if(allocated(Hist_N_Ps48_FA)) deallocate(Hist_N_Ps48_FA)
   if(allocated(Hist_N_Pm48_FA)) deallocate(Hist_N_Pm48_FA)
   if(allocated(Hist_N_Pm49_FA)) deallocate(Hist_N_Pm49_FA)
   if(allocated(Hist_N_Sm47_FA)) deallocate(Hist_N_Sm47_FA)
   if(allocated(Hist_N_Sm48_FA)) deallocate(Hist_N_Sm48_FA)
   if(allocated(Hist_N_Sm49_FA)) deallocate(Hist_N_Sm49_FA)
   if(allocated(Hist_N_Gd52_FA)) deallocate(Hist_N_Gd52_FA)
   if(allocated(Hist_N_Gd54_FA)) deallocate(Hist_N_Gd54_FA)
   if(allocated(Hist_N_Gd55_FA)) deallocate(Hist_N_Gd55_FA)
   if(allocated(Hist_N_Gd56_FA)) deallocate(Hist_N_Gd56_FA)
   if(allocated(Hist_N_Gd57_FA)) deallocate(Hist_N_Gd57_FA)
   if(allocated(Hist_N_Gd58_FA)) deallocate(Hist_N_Gd58_FA)
   if(allocated(Hist_N_Gd60_FA)) deallocate(Hist_N_Gd60_FA)
   if(allocated(Hist_N_U34_FA)) deallocate(Hist_N_U34_FA)
   if(allocated(Hist_N_U35_FA)) deallocate(Hist_N_U35_FA)
   if(allocated(Hist_N_U36_FA)) deallocate(Hist_N_U36_FA)
   if(allocated(Hist_N_U37_FA)) deallocate(Hist_N_U37_FA)
   if(allocated(Hist_N_U38_FA)) deallocate(Hist_N_U38_FA)
   if(allocated(Hist_N_Np37_FA)) deallocate(Hist_N_Np37_FA)
   if(allocated(Hist_N_Np38_FA)) deallocate(Hist_N_Np38_FA)
   if(allocated(Hist_N_Np39_FA)) deallocate(Hist_N_Np39_FA)
   if(allocated(Hist_N_Pu38_FA)) deallocate(Hist_N_Pu38_FA)
   if(allocated(Hist_N_Pu39_FA)) deallocate(Hist_N_Pu39_FA)
   if(allocated(Hist_N_Pu40_FA)) deallocate(Hist_N_Pu40_FA)
   if(allocated(Hist_N_Pu41_FA)) deallocate(Hist_N_Pu41_FA)
   if(allocated(Hist_N_Pu42_FA)) deallocate(Hist_N_Pu42_FA)
   if(allocated(Hist_N_Pu43_FA)) deallocate(Hist_N_Pu43_FA)
   if(allocated(Hist_N_Am41_FA)) deallocate(Hist_N_Am41_FA)
   if(allocated(Hist_N_As42_FA)) deallocate(Hist_N_As42_FA)
   if(allocated(Hist_N_Am42_FA)) deallocate(Hist_N_Am42_FA)
   if(allocated(Hist_N_Am43_FA)) deallocate(Hist_N_Am43_FA)
   if(allocated(Hist_N_Am44_FA)) deallocate(Hist_N_Am44_FA)
   if(allocated(Hist_N_Cm42_FA)) deallocate(Hist_N_Cm42_FA)
   if(allocated(Hist_N_Cm43_FA)) deallocate(Hist_N_Cm43_FA)
   if(allocated(Hist_N_Cm44_FA)) deallocate(Hist_N_Cm44_FA)
   if(allocated(Hist_Flux)) deallocate(Hist_Flux)
   if(allocated(Hist_maXS_tr_3D)) deallocate(Hist_maXS_tr_3D)
   if(allocated(Hist_D_3D)) deallocate(Hist_D_3D)
   if(allocated(Hist_maXS_a_3D)) deallocate(Hist_maXS_a_3D)
   if(allocated(Hist_maXS_f_3D)) deallocate(Hist_maXS_f_3D)
   if(allocated(Hist_nu_maXS_f_3D)) deallocate(Hist_nu_maXS_f_3D)
   if(allocated(Hist_kap_maXS_f_3D)) deallocate(Hist_kap_maXS_f_3D)
   if(allocated(Hist_maXS_s_3D)) deallocate(Hist_maXS_s_3D)
   if(allocated(Hist_maXS_r_3D)) deallocate(Hist_maXS_r_3D)
   if(allocated(Hist_ADF_Lx)) deallocate(Hist_ADF_Lx)
   if(allocated(Hist_ADF_Rx)) deallocate(Hist_ADF_Rx)
   if(allocated(Hist_ADF_Ly)) deallocate(Hist_ADF_Ly)
   if(allocated(Hist_ADF_Ry)) deallocate(Hist_ADF_Ry)
   if(allocated(Hist_CDF_LxLy)) deallocate(Hist_CDF_LxLy)
   if(allocated(Hist_CDF_LxRy)) deallocate(Hist_CDF_LxRy)
   if(allocated(Hist_CDF_RxLy)) deallocate(Hist_CDF_RxLy)
   if(allocated(Hist_CDF_RxRy)) deallocate(Hist_CDF_RxRy)
   if(allocated(Hist_DR)) deallocate(Hist_DR)
   if(allocated(Hist_ASI_DR)) deallocate(Hist_ASI_DR)
   if(allocated(Hist_det_sig_rr)) deallocate(Hist_det_sig_rr)
   if(allocated(Hist_det_detpow)) deallocate(Hist_det_detpow)
   if(allocated(Hist_det_wprime)) deallocate(Hist_det_wprime)
   if(allocated(Hist_PinPOW_3D)) deallocate(Hist_PinPOW_3D)
   if(allocated(Hist_PinBU_3D)) deallocate(Hist_PinBU_3D)
   if(allocated(Hist_PinPOW_2D)) deallocate(Hist_PinPOW_2D)
   if(allocated(Hist_PinBU_2D)) deallocate(Hist_PinBU_2D)
   if(allocated(Hist_PinQ_2D)) deallocate(Hist_PinQ_2D)
   if(allocated(I_MRI_cycle)) deallocate(I_MRI_cycle)
   if(allocated(I_Shuffle_1N)) deallocate(I_Shuffle_1N)
   if(allocated(I_Rotate_1N)) deallocate(I_Rotate_1N)
   if(allocated(I_ATF_TCD_1N)) deallocate(I_ATF_TCD_1N)
   if(allocated(I_ATF_TCD)) deallocate(I_ATF_TCD)
   if(allocated(I_ATF_TCD_FA_1N)) deallocate(I_ATF_TCD_FA_1N)
   if(allocated(I_ATF_TCD_FA)) deallocate(I_ATF_TCD_FA)
   if(allocated(I_ATF_TCD_FA_RF)) deallocate(I_ATF_TCD_FA_RF)
   if(allocated(beta_d_Tot)) deallocate(beta_d_Tot)
   if(allocated(beta_d)) deallocate(beta_d)
   if(allocated(beta_d_eff)) deallocate(beta_d_eff)
   if(allocated(lambda_d)) deallocate(lambda_d)
   if(allocated(v_Inv)) deallocate(v_Inv)
   if(allocated(Avg_Flux)) deallocate(Avg_Flux)
   !if(allocated(D)) deallocate(D)
   !if(allocated(maXS_tr)) deallocate(maXS_tr)
   !if(allocated(maXS_a)) deallocate(maXS_a)
   !if(allocated(maXS_f)) deallocate(maXS_f)
   !if(allocated(nu_maXS_f)) deallocate(nu_maXS_f)
   !if(allocated(kap_maXS_f)) deallocate(kap_maXS_f)
   !if(allocated(maXS_s)) deallocate(maXS_s)
   !if(allocated(maXS_r)) deallocate(maXS_r)
   if(allocated(D_3D)) deallocate(D_3D)
   if(allocated(maXS_tr_3D)) deallocate(maXS_tr_3D)
   if(allocated(maXS_a_3D)) deallocate(maXS_a_3D)
   if(allocated(maXS_f_3D)) deallocate(maXS_f_3D)
   if(allocated(nu_maXS_f_3D)) deallocate(nu_maXS_f_3D)
   if(allocated(kap_maXS_f_3D)) deallocate(kap_maXS_f_3D)
   if(allocated(maXS_s_3D)) deallocate(maXS_s_3D)
   if(allocated(maXS_r_3D)) deallocate(maXS_r_3D)
   if(allocated(maXS_f_3D_Old)) deallocate(maXS_f_3D_Old)
   if(allocated(D_3D_lc)) deallocate(D_3D_lc)
   if(allocated(maXS_a_3D_lc)) deallocate(maXS_a_3D_lc)
   if(allocated(maXS_s_3D_lc)) deallocate(maXS_s_3D_lc)
   if(allocated(buck2_lc)) deallocate(buck2_lc)
   if(allocated(dbuck2_lc)) deallocate(dbuck2_lc)
   if(allocated(miXS_tr_U34)) deallocate(miXS_tr_U34)
   if(allocated(miXS_tr_U35)) deallocate(miXS_tr_U35)
   if(allocated(miXS_tr_U36)) deallocate(miXS_tr_U36)
   if(allocated(miXS_tr_U37)) deallocate(miXS_tr_U37)
   if(allocated(miXS_tr_U38)) deallocate(miXS_tr_U38)
   if(allocated(miXS_tr_Np37)) deallocate(miXS_tr_Np37)
   if(allocated(miXS_tr_Np38)) deallocate(miXS_tr_Np38)
   if(allocated(miXS_tr_Np39)) deallocate(miXS_tr_Np39)
   if(allocated(miXS_tr_Pu38)) deallocate(miXS_tr_Pu38)
   if(allocated(miXS_tr_Pu39)) deallocate(miXS_tr_Pu39)
   if(allocated(miXS_tr_Pu40)) deallocate(miXS_tr_Pu40)
   if(allocated(miXS_tr_Pu41)) deallocate(miXS_tr_Pu41)
   if(allocated(miXS_tr_Pu42)) deallocate(miXS_tr_Pu42)
   if(allocated(miXS_tr_Pu43)) deallocate(miXS_tr_Pu43)
   if(allocated(miXS_tr_Am41)) deallocate(miXS_tr_Am41)
   if(allocated(miXS_tr_As42)) deallocate(miXS_tr_As42)
   if(allocated(miXS_tr_Am42)) deallocate(miXS_tr_Am42)
   if(allocated(miXS_tr_Am43)) deallocate(miXS_tr_Am43)
   if(allocated(miXS_tr_Am44)) deallocate(miXS_tr_Am44)
   if(allocated(miXS_tr_Cm42)) deallocate(miXS_tr_Cm42)
   if(allocated(miXS_tr_Cm43)) deallocate(miXS_tr_Cm43)
   if(allocated(miXS_tr_Cm44)) deallocate(miXS_tr_Cm44)
   if(allocated(miXS_a_U34)) deallocate(miXS_a_U34)
   if(allocated(miXS_a_U35)) deallocate(miXS_a_U35)
   if(allocated(miXS_a_U36)) deallocate(miXS_a_U36)
   if(allocated(miXS_a_U37)) deallocate(miXS_a_U37)
   if(allocated(miXS_a_U38)) deallocate(miXS_a_U38)
   if(allocated(miXS_a_Np37)) deallocate(miXS_a_Np37)
   if(allocated(miXS_a_Np38)) deallocate(miXS_a_Np38)
   if(allocated(miXS_a_Np39)) deallocate(miXS_a_Np39)
   if(allocated(miXS_a_Pu38)) deallocate(miXS_a_Pu38)
   if(allocated(miXS_a_Pu39)) deallocate(miXS_a_Pu39)
   if(allocated(miXS_a_Pu40)) deallocate(miXS_a_Pu40)
   if(allocated(miXS_a_Pu41)) deallocate(miXS_a_Pu41)
   if(allocated(miXS_a_Pu42)) deallocate(miXS_a_Pu42)
   if(allocated(miXS_a_Pu43)) deallocate(miXS_a_Pu43)
   if(allocated(miXS_a_Am41)) deallocate(miXS_a_Am41)
   if(allocated(miXS_a_As42)) deallocate(miXS_a_As42)
   if(allocated(miXS_a_Am42)) deallocate(miXS_a_Am42)
   if(allocated(miXS_a_Am43)) deallocate(miXS_a_Am43)
   if(allocated(miXS_a_Am44)) deallocate(miXS_a_Am44)
   if(allocated(miXS_a_Cm42)) deallocate(miXS_a_Cm42)
   if(allocated(miXS_a_Cm43)) deallocate(miXS_a_Cm43)
   if(allocated(miXS_a_Cm44)) deallocate(miXS_a_Cm44)
   if(allocated(miXS_a_U34_Old)) deallocate(miXS_a_U34_Old)
   if(allocated(miXS_a_U35_Old)) deallocate(miXS_a_U35_Old)
   if(allocated(miXS_a_U36_Old)) deallocate(miXS_a_U36_Old)
   if(allocated(miXS_a_U37_Old)) deallocate(miXS_a_U37_Old)
   if(allocated(miXS_a_U38_Old)) deallocate(miXS_a_U38_Old)
   if(allocated(miXS_a_Np37_Old)) deallocate(miXS_a_Np37_Old)
   if(allocated(miXS_a_Np38_Old)) deallocate(miXS_a_Np38_Old)
   if(allocated(miXS_a_Np39_Old)) deallocate(miXS_a_Np39_Old)
   if(allocated(miXS_a_Pu38_Old)) deallocate(miXS_a_Pu38_Old)
   if(allocated(miXS_a_Pu39_Old)) deallocate(miXS_a_Pu39_Old)
   if(allocated(miXS_a_Pu40_Old)) deallocate(miXS_a_Pu40_Old)
   if(allocated(miXS_a_Pu41_Old)) deallocate(miXS_a_Pu41_Old)
   if(allocated(miXS_a_Pu42_Old)) deallocate(miXS_a_Pu42_Old)
   if(allocated(miXS_a_Pu43_Old)) deallocate(miXS_a_Pu43_Old)
   if(allocated(miXS_a_Am41_Old)) deallocate(miXS_a_Am41_Old)
   if(allocated(miXS_a_As42_Old)) deallocate(miXS_a_As42_Old)
   if(allocated(miXS_a_Am42_Old)) deallocate(miXS_a_Am42_Old)
   if(allocated(miXS_a_Am43_Old)) deallocate(miXS_a_Am43_Old)
   if(allocated(miXS_a_Am44_Old)) deallocate(miXS_a_Am44_Old)
   if(allocated(miXS_a_Cm42_Old)) deallocate(miXS_a_Cm42_Old)
   if(allocated(miXS_a_Cm43_Old)) deallocate(miXS_a_Cm43_Old)
   if(allocated(miXS_a_Cm44_Old)) deallocate(miXS_a_Cm44_Old)
   if(allocated(miXS_f_U34)) deallocate(miXS_f_U34)
   if(allocated(miXS_f_U35)) deallocate(miXS_f_U35)
   if(allocated(miXS_f_U36)) deallocate(miXS_f_U36)
   if(allocated(miXS_f_U37)) deallocate(miXS_f_U37)
   if(allocated(miXS_f_U38)) deallocate(miXS_f_U38)
   if(allocated(miXS_f_Np37)) deallocate(miXS_f_Np37)
   if(allocated(miXS_f_Np38)) deallocate(miXS_f_Np38)
   if(allocated(miXS_f_Np39)) deallocate(miXS_f_Np39)
   if(allocated(miXS_f_Pu38)) deallocate(miXS_f_Pu38)
   if(allocated(miXS_f_Pu39)) deallocate(miXS_f_Pu39)
   if(allocated(miXS_f_Pu40)) deallocate(miXS_f_Pu40)
   if(allocated(miXS_f_Pu41)) deallocate(miXS_f_Pu41)
   if(allocated(miXS_f_Pu42)) deallocate(miXS_f_Pu42)
   if(allocated(miXS_f_Pu43)) deallocate(miXS_f_Pu43)
   if(allocated(miXS_f_Am41)) deallocate(miXS_f_Am41)
   if(allocated(miXS_f_As42)) deallocate(miXS_f_As42)
   if(allocated(miXS_f_Am42)) deallocate(miXS_f_Am42)
   if(allocated(miXS_f_Am43)) deallocate(miXS_f_Am43)
   if(allocated(miXS_f_Am44)) deallocate(miXS_f_Am44)
   if(allocated(miXS_f_Cm42)) deallocate(miXS_f_Cm42)
   if(allocated(miXS_f_Cm43)) deallocate(miXS_f_Cm43)
   if(allocated(miXS_f_Cm44)) deallocate(miXS_f_Cm44)
   if(allocated(miXS_f_U34_Old)) deallocate(miXS_f_U34_Old)
   if(allocated(miXS_f_U35_Old)) deallocate(miXS_f_U35_Old)
   if(allocated(miXS_f_U36_Old)) deallocate(miXS_f_U36_Old)
   if(allocated(miXS_f_U37_Old)) deallocate(miXS_f_U37_Old)
   if(allocated(miXS_f_U38_Old)) deallocate(miXS_f_U38_Old)
   if(allocated(miXS_f_Np37_Old)) deallocate(miXS_f_Np37_Old)
   if(allocated(miXS_f_Np38_Old)) deallocate(miXS_f_Np38_Old)
   if(allocated(miXS_f_Np39_Old)) deallocate(miXS_f_Np39_Old)
   if(allocated(miXS_f_Pu38_Old)) deallocate(miXS_f_Pu38_Old)
   if(allocated(miXS_f_Pu39_Old)) deallocate(miXS_f_Pu39_Old)
   if(allocated(miXS_f_Pu40_Old)) deallocate(miXS_f_Pu40_Old)
   if(allocated(miXS_f_Pu41_Old)) deallocate(miXS_f_Pu41_Old)
   if(allocated(miXS_f_Pu42_Old)) deallocate(miXS_f_Pu42_Old)
   if(allocated(miXS_f_Pu43_Old)) deallocate(miXS_f_Pu43_Old)
   if(allocated(miXS_f_Am41_Old)) deallocate(miXS_f_Am41_Old)
   if(allocated(miXS_f_As42_Old)) deallocate(miXS_f_As42_Old)
   if(allocated(miXS_f_Am42_Old)) deallocate(miXS_f_Am42_Old)
   if(allocated(miXS_f_Am43_Old)) deallocate(miXS_f_Am43_Old)
   if(allocated(miXS_f_Am44_Old)) deallocate(miXS_f_Am44_Old)
   if(allocated(miXS_f_Cm42_Old)) deallocate(miXS_f_Cm42_Old)
   if(allocated(miXS_f_Cm43_Old)) deallocate(miXS_f_Cm43_Old)
   if(allocated(miXS_f_Cm44_Old)) deallocate(miXS_f_Cm44_Old)
   if(allocated(nu_miXS_f_U34)) deallocate(nu_miXS_f_U34)
   if(allocated(nu_miXS_f_U35)) deallocate(nu_miXS_f_U35)
   if(allocated(nu_miXS_f_U36)) deallocate(nu_miXS_f_U36)
   if(allocated(nu_miXS_f_U37)) deallocate(nu_miXS_f_U37)
   if(allocated(nu_miXS_f_U38)) deallocate(nu_miXS_f_U38)
   if(allocated(nu_miXS_f_Np37)) deallocate(nu_miXS_f_Np37)
   if(allocated(nu_miXS_f_Np38)) deallocate(nu_miXS_f_Np38)
   if(allocated(nu_miXS_f_Np39)) deallocate(nu_miXS_f_Np39)
   if(allocated(nu_miXS_f_Pu38)) deallocate(nu_miXS_f_Pu38)
   if(allocated(nu_miXS_f_Pu39)) deallocate(nu_miXS_f_Pu39)
   if(allocated(nu_miXS_f_Pu40)) deallocate(nu_miXS_f_Pu40)
   if(allocated(nu_miXS_f_Pu41)) deallocate(nu_miXS_f_Pu41)
   if(allocated(nu_miXS_f_Pu42)) deallocate(nu_miXS_f_Pu42)
   if(allocated(nu_miXS_f_Pu43)) deallocate(nu_miXS_f_Pu43)
   if(allocated(nu_miXS_f_Am41)) deallocate(nu_miXS_f_Am41)
   if(allocated(nu_miXS_f_As42)) deallocate(nu_miXS_f_As42)
   if(allocated(nu_miXS_f_Am42)) deallocate(nu_miXS_f_Am42)
   if(allocated(nu_miXS_f_Am43)) deallocate(nu_miXS_f_Am43)
   if(allocated(nu_miXS_f_Am44)) deallocate(nu_miXS_f_Am44)
   if(allocated(nu_miXS_f_Cm42)) deallocate(nu_miXS_f_Cm42)
   if(allocated(nu_miXS_f_Cm43)) deallocate(nu_miXS_f_Cm43)
   if(allocated(nu_miXS_f_Cm44)) deallocate(nu_miXS_f_Cm44)
   if(allocated(kap_miXS_f_U34)) deallocate(kap_miXS_f_U34)
   if(allocated(kap_miXS_f_U35)) deallocate(kap_miXS_f_U35)
   if(allocated(kap_miXS_f_U36)) deallocate(kap_miXS_f_U36)
   if(allocated(kap_miXS_f_U37)) deallocate(kap_miXS_f_U37)
   if(allocated(kap_miXS_f_U38)) deallocate(kap_miXS_f_U38)
   if(allocated(kap_miXS_f_Np37)) deallocate(kap_miXS_f_Np37)
   if(allocated(kap_miXS_f_Np38)) deallocate(kap_miXS_f_Np38)
   if(allocated(kap_miXS_f_Np39)) deallocate(kap_miXS_f_Np39)
   if(allocated(kap_miXS_f_Pu38)) deallocate(kap_miXS_f_Pu38)
   if(allocated(kap_miXS_f_Pu39)) deallocate(kap_miXS_f_Pu39)
   if(allocated(kap_miXS_f_Pu40)) deallocate(kap_miXS_f_Pu40)
   if(allocated(kap_miXS_f_Pu41)) deallocate(kap_miXS_f_Pu41)
   if(allocated(kap_miXS_f_Pu42)) deallocate(kap_miXS_f_Pu42)
   if(allocated(kap_miXS_f_Pu43)) deallocate(kap_miXS_f_Pu43)
   if(allocated(kap_miXS_f_Am41)) deallocate(kap_miXS_f_Am41)
   if(allocated(kap_miXS_f_As42)) deallocate(kap_miXS_f_As42)
   if(allocated(kap_miXS_f_Am42)) deallocate(kap_miXS_f_Am42)
   if(allocated(kap_miXS_f_Am43)) deallocate(kap_miXS_f_Am43)
   if(allocated(kap_miXS_f_Am44)) deallocate(kap_miXS_f_Am44)
   if(allocated(kap_miXS_f_Cm42)) deallocate(kap_miXS_f_Cm42)
   if(allocated(kap_miXS_f_Cm43)) deallocate(kap_miXS_f_Cm43)
   if(allocated(kap_miXS_f_Cm44)) deallocate(kap_miXS_f_Cm44)
   if(allocated(miXS_s_U34)) deallocate(miXS_s_U34)
   if(allocated(miXS_s_U35)) deallocate(miXS_s_U35)
   if(allocated(miXS_s_U36)) deallocate(miXS_s_U36)
   if(allocated(miXS_s_U37)) deallocate(miXS_s_U37)
   if(allocated(miXS_s_U38)) deallocate(miXS_s_U38)
   if(allocated(miXS_s_Np37)) deallocate(miXS_s_Np37)
   if(allocated(miXS_s_Np38)) deallocate(miXS_s_Np38)
   if(allocated(miXS_s_Np39)) deallocate(miXS_s_Np39)
   if(allocated(miXS_s_Pu38)) deallocate(miXS_s_Pu38)
   if(allocated(miXS_s_Pu39)) deallocate(miXS_s_Pu39)
   if(allocated(miXS_s_Pu40)) deallocate(miXS_s_Pu40)
   if(allocated(miXS_s_Pu41)) deallocate(miXS_s_Pu41)
   if(allocated(miXS_s_Pu42)) deallocate(miXS_s_Pu42)
   if(allocated(miXS_s_Pu43)) deallocate(miXS_s_Pu43)
   if(allocated(miXS_s_Am41)) deallocate(miXS_s_Am41)
   if(allocated(miXS_s_As42)) deallocate(miXS_s_As42)
   if(allocated(miXS_s_Am42)) deallocate(miXS_s_Am42)
   if(allocated(miXS_s_Am43)) deallocate(miXS_s_Am43)
   if(allocated(miXS_s_Am44)) deallocate(miXS_s_Am44)
   if(allocated(miXS_s_Cm42)) deallocate(miXS_s_Cm42)
   if(allocated(miXS_s_Cm43)) deallocate(miXS_s_Cm43)
   if(allocated(miXS_s_Cm44)) deallocate(miXS_s_Cm44)
   if(allocated(miXS_n2n_U35)) deallocate(miXS_n2n_U35)
   if(allocated(miXS_n2n_U38)) deallocate(miXS_n2n_U38)
   if(allocated(miXS_n2n_Np37)) deallocate(miXS_n2n_Np37)
   if(allocated(miXS_n2n_Pu39)) deallocate(miXS_n2n_Pu39)
   if(allocated(miXS_n2n_U35_Old)) deallocate(miXS_n2n_U35_Old)
   if(allocated(miXS_n2n_U38_Old)) deallocate(miXS_n2n_U38_Old)
   if(allocated(miXS_n2n_Np37_Old)) deallocate(miXS_n2n_Np37_Old)
   if(allocated(miXS_n2n_Pu39_Old)) deallocate(miXS_n2n_Pu39_Old)
   if(allocated(miXS_tr_I35)) deallocate(miXS_tr_I35)
   if(allocated(miXS_tr_Xe35)) deallocate(miXS_tr_Xe35)
   if(allocated(miXS_tr_Nd47)) deallocate(miXS_tr_Nd47)
   if(allocated(miXS_tr_Nd48)) deallocate(miXS_tr_Nd48)
   if(allocated(miXS_tr_Nd49)) deallocate(miXS_tr_Nd49)
   if(allocated(miXS_tr_Pm47)) deallocate(miXS_tr_Pm47)
   if(allocated(miXS_tr_Ps48)) deallocate(miXS_tr_Ps48)
   if(allocated(miXS_tr_Pm48)) deallocate(miXS_tr_Pm48)
   if(allocated(miXS_tr_Pm49)) deallocate(miXS_tr_Pm49)
   if(allocated(miXS_tr_Sm47)) deallocate(miXS_tr_Sm47)
   if(allocated(miXS_tr_Sm48)) deallocate(miXS_tr_Sm48)
   if(allocated(miXS_tr_Sm49)) deallocate(miXS_tr_Sm49)
   if(allocated(miXS_a_I35)) deallocate(miXS_a_I35)
   if(allocated(miXS_a_Xe35)) deallocate(miXS_a_Xe35)
   if(allocated(miXS_a_Nd47)) deallocate(miXS_a_Nd47)
   if(allocated(miXS_a_Nd48)) deallocate(miXS_a_Nd48)
   if(allocated(miXS_a_Nd49)) deallocate(miXS_a_Nd49)
   if(allocated(miXS_a_Pm47)) deallocate(miXS_a_Pm47)
   if(allocated(miXS_a_Ps48)) deallocate(miXS_a_Ps48)
   if(allocated(miXS_a_Pm48)) deallocate(miXS_a_Pm48)
   if(allocated(miXS_a_Pm49)) deallocate(miXS_a_Pm49)
   if(allocated(miXS_a_Sm47)) deallocate(miXS_a_Sm47)
   if(allocated(miXS_a_Sm48)) deallocate(miXS_a_Sm48)
   if(allocated(miXS_a_Sm49)) deallocate(miXS_a_Sm49)
   if(allocated(miXS_a_I35_Old)) deallocate(miXS_a_I35_Old)
   if(allocated(miXS_a_Xe35_Old)) deallocate(miXS_a_Xe35_Old)
   if(allocated(miXS_a_Nd47_Old)) deallocate(miXS_a_Nd47_Old)
   if(allocated(miXS_a_Nd48_Old)) deallocate(miXS_a_Nd48_Old)
   if(allocated(miXS_a_Nd49_Old)) deallocate(miXS_a_Nd49_Old)
   if(allocated(miXS_a_Pm47_Old)) deallocate(miXS_a_Pm47_Old)
   if(allocated(miXS_a_Ps48_Old)) deallocate(miXS_a_Ps48_Old)
   if(allocated(miXS_a_Pm48_Old)) deallocate(miXS_a_Pm48_Old)
   if(allocated(miXS_a_Pm49_Old)) deallocate(miXS_a_Pm49_Old)
   if(allocated(miXS_a_Sm47_Old)) deallocate(miXS_a_Sm47_Old)
   if(allocated(miXS_a_Sm48_Old)) deallocate(miXS_a_Sm48_Old)
   if(allocated(miXS_a_Sm49_Old)) deallocate(miXS_a_Sm49_Old)
   if(allocated(miXS_s_I35)) deallocate(miXS_s_I35)
   if(allocated(miXS_s_Xe35)) deallocate(miXS_s_Xe35)
   if(allocated(miXS_s_Nd47)) deallocate(miXS_s_Nd47)
   if(allocated(miXS_s_Nd48)) deallocate(miXS_s_Nd48)
   if(allocated(miXS_s_Nd49)) deallocate(miXS_s_Nd49)
   if(allocated(miXS_s_Pm47)) deallocate(miXS_s_Pm47)
   if(allocated(miXS_s_Ps48)) deallocate(miXS_s_Ps48)
   if(allocated(miXS_s_Pm48)) deallocate(miXS_s_Pm48)
   if(allocated(miXS_s_Pm49)) deallocate(miXS_s_Pm49)
   if(allocated(miXS_s_Sm47)) deallocate(miXS_s_Sm47)
   if(allocated(miXS_s_Sm48)) deallocate(miXS_s_Sm48)
   if(allocated(miXS_s_Sm49)) deallocate(miXS_s_Sm49)
   if(allocated(miXS_s_I35_Old)) deallocate(miXS_s_I35_Old)
   if(allocated(miXS_s_Xe35_Old)) deallocate(miXS_s_Xe35_Old)
   if(allocated(miXS_s_Nd47_Old)) deallocate(miXS_s_Nd47_Old)
   if(allocated(miXS_s_Nd48_Old)) deallocate(miXS_s_Nd48_Old)
   if(allocated(miXS_s_Nd49_Old)) deallocate(miXS_s_Nd49_Old)
   if(allocated(miXS_s_Pm47_Old)) deallocate(miXS_s_Pm47_Old)
   if(allocated(miXS_s_Ps48_Old)) deallocate(miXS_s_Ps48_Old)
   if(allocated(miXS_s_Pm48_Old)) deallocate(miXS_s_Pm48_Old)
   if(allocated(miXS_s_Pm49_Old)) deallocate(miXS_s_Pm49_Old)
   if(allocated(miXS_s_Sm47_Old)) deallocate(miXS_s_Sm47_Old)
   if(allocated(miXS_s_Sm48_Old)) deallocate(miXS_s_Sm48_Old)
   if(allocated(miXS_s_Sm49_Old)) deallocate(miXS_s_Sm49_Old)
   if(allocated(miXS_tr_Gd52)) deallocate(miXS_tr_Gd52)
   if(allocated(miXS_tr_Gd54)) deallocate(miXS_tr_Gd54)
   if(allocated(miXS_tr_Gd55)) deallocate(miXS_tr_Gd55)
   if(allocated(miXS_tr_Gd56)) deallocate(miXS_tr_Gd56)
   if(allocated(miXS_tr_Gd57)) deallocate(miXS_tr_Gd57)
   if(allocated(miXS_tr_Gd58)) deallocate(miXS_tr_Gd58)
   if(allocated(miXS_tr_Gd60)) deallocate(miXS_tr_Gd60)
   if(allocated(miXS_a_Gd52)) deallocate(miXS_a_Gd52)
   if(allocated(miXS_a_Gd54)) deallocate(miXS_a_Gd54)
   if(allocated(miXS_a_Gd55)) deallocate(miXS_a_Gd55)
   if(allocated(miXS_a_Gd56)) deallocate(miXS_a_Gd56)
   if(allocated(miXS_a_Gd57)) deallocate(miXS_a_Gd57)
   if(allocated(miXS_a_Gd58)) deallocate(miXS_a_Gd58)
   if(allocated(miXS_a_Gd60)) deallocate(miXS_a_Gd60)
   if(allocated(miXS_a_Gd52_Old)) deallocate(miXS_a_Gd52_Old)
   if(allocated(miXS_a_Gd54_Old)) deallocate(miXS_a_Gd54_Old)
   if(allocated(miXS_a_Gd55_Old)) deallocate(miXS_a_Gd55_Old)
   if(allocated(miXS_a_Gd56_Old)) deallocate(miXS_a_Gd56_Old)
   if(allocated(miXS_a_Gd57_Old)) deallocate(miXS_a_Gd57_Old)
   if(allocated(miXS_a_Gd58_Old)) deallocate(miXS_a_Gd58_Old)
   if(allocated(miXS_a_Gd60_Old)) deallocate(miXS_a_Gd60_Old)
   if(allocated(miXS_s_Gd52)) deallocate(miXS_s_Gd52)
   if(allocated(miXS_s_Gd54)) deallocate(miXS_s_Gd54)
   if(allocated(miXS_s_Gd55)) deallocate(miXS_s_Gd55)
   if(allocated(miXS_s_Gd56)) deallocate(miXS_s_Gd56)
   if(allocated(miXS_s_Gd57)) deallocate(miXS_s_Gd57)
   if(allocated(miXS_s_Gd58)) deallocate(miXS_s_Gd58)
   if(allocated(miXS_s_Gd60)) deallocate(miXS_s_Gd60)
   if(allocated(miXS_tr_H2O)) deallocate(miXS_tr_H2O)
   if(allocated(miXS_tr_B0)) deallocate(miXS_tr_B0)
   if(allocated(miXS_a_H2O)) deallocate(miXS_a_H2O)
   if(allocated(miXS_a_B0)) deallocate(miXS_a_B0)
   if(allocated(miXS_a_H2O_Old)) deallocate(miXS_a_H2O_Old)
   if(allocated(miXS_a_B0_Old)) deallocate(miXS_a_B0_Old)
   if(allocated(miXS_s_H2O)) deallocate(miXS_s_H2O)
   if(allocated(miXS_s_B0)) deallocate(miXS_s_B0)
   if(allocated(Y_I35)) deallocate(Y_I35)
   if(allocated(Y_Xe35)) deallocate(Y_Xe35)
   if(allocated(Y_Nd47)) deallocate(Y_Nd47)
   if(allocated(Y_Nd48)) deallocate(Y_Nd48)
   if(allocated(Y_Nd49)) deallocate(Y_Nd49)
   if(allocated(Y_Pm47)) deallocate(Y_Pm47)
   if(allocated(Y_Ps48)) deallocate(Y_Ps48)
   if(allocated(Y_Pm48)) deallocate(Y_Pm48)
   if(allocated(Y_Pm49)) deallocate(Y_Pm49)
   if(allocated(Y_Sm49)) deallocate(Y_Sm49)
   if(allocated(Y_Xe35_eff)) deallocate(Y_Xe35_eff)
   if(allocated(Y_Pm49_eff)) deallocate(Y_Pm49_eff)
   if(allocated(Y_I35_Old)) deallocate(Y_I35_Old)
   if(allocated(Y_Xe35_Old)) deallocate(Y_Xe35_Old)
   if(allocated(Y_Nd47_Old)) deallocate(Y_Nd47_Old)
   if(allocated(Y_Nd48_Old)) deallocate(Y_Nd48_Old)
   if(allocated(Y_Nd49_Old)) deallocate(Y_Nd49_Old)
   if(allocated(Y_Pm47_Old)) deallocate(Y_Pm47_Old)
   if(allocated(Y_Ps48_Old)) deallocate(Y_Ps48_Old)
   if(allocated(Y_Pm48_Old)) deallocate(Y_Pm48_Old)
   if(allocated(Y_Pm49_Old)) deallocate(Y_Pm49_Old)
   if(allocated(Y_Sm49_Old)) deallocate(Y_Sm49_Old)
   if(allocated(Y_Xe35_eff_Old)) deallocate(Y_Xe35_eff_Old)
   if(allocated(Y_Pm49_eff_Old)) deallocate(Y_Pm49_eff_Old)
   if(allocated(miXS_a_A1)) deallocate(miXS_a_A1)
   if(allocated(miXS_a_A2)) deallocate(miXS_a_A2)
   if(allocated(miXS_a_A2m)) deallocate(miXS_a_A2m)
   if(allocated(miXS_a_A3)) deallocate(miXS_a_A3)
   if(allocated(miXS_a_B2)) deallocate(miXS_a_B2)
   if(allocated(miXS_a_B3)) deallocate(miXS_a_B3)
   if(allocated(miXS_a_A4)) deallocate(miXS_a_A4)
   if(allocated(miXS_a_V1)) deallocate(miXS_a_V1)
   if(allocated(miXS_a_V2)) deallocate(miXS_a_V2)
   if(allocated(miXS_a_Cr)) deallocate(miXS_a_Cr)
   if(allocated(DET_miXS_a_A1)) deallocate(DET_miXS_a_A1)
   if(allocated(DET_miXS_a_A2)) deallocate(DET_miXS_a_A2)
   if(allocated(DET_miXS_a_A2m)) deallocate(DET_miXS_a_A2m)
   if(allocated(DET_miXS_a_A3)) deallocate(DET_miXS_a_A3)
   if(allocated(DET_miXS_a_B2)) deallocate(DET_miXS_a_B2)
   if(allocated(DET_miXS_a_B3)) deallocate(DET_miXS_a_B3)
   if(allocated(DET_miXS_a_A4)) deallocate(DET_miXS_a_A4)
   if(allocated(DET_miXS_a_V1)) deallocate(DET_miXS_a_V1)
   if(allocated(DET_miXS_a_V2)) deallocate(DET_miXS_a_V2)
   if(allocated(DET_miXS_a_Cr)) deallocate(DET_miXS_a_Cr)
   if(allocated(miXS_a_B10)) deallocate(miXS_a_B10)
   if(allocated(XS_DEP_B10)) deallocate(XS_DEP_B10)
   if(allocated(temp_DEP_B10)) deallocate(temp_DEP_B10)
   if(allocated(XS_DEP_B10_BASE)) deallocate(XS_DEP_B10_BASE)

   if(allocated(N_U34)) deallocate(N_U34)
   if(allocated(N_U35)) deallocate(N_U35)
   if(allocated(N_U36)) deallocate(N_U36)
   if(allocated(N_U37)) deallocate(N_U37)
   if(allocated(N_U38)) deallocate(N_U38)
   if(allocated(N_Np37)) deallocate(N_Np37)
   if(allocated(N_Np38)) deallocate(N_Np38)
   if(allocated(N_Np39)) deallocate(N_Np39)
   if(allocated(N_Pu38)) deallocate(N_Pu38)
   if(allocated(N_Pu39)) deallocate(N_Pu39)
   if(allocated(N_Pu40)) deallocate(N_Pu40)
   if(allocated(N_Pu41)) deallocate(N_Pu41)
   if(allocated(N_Pu42)) deallocate(N_Pu42)
   if(allocated(N_Pu43)) deallocate(N_Pu43)
   if(allocated(N_Am41)) deallocate(N_Am41)
   if(allocated(N_As42)) deallocate(N_As42)
   if(allocated(N_Am42)) deallocate(N_Am42)
   if(allocated(N_Am43)) deallocate(N_Am43)
   if(allocated(N_Am44)) deallocate(N_Am44)
   if(allocated(N_Cm42)) deallocate(N_Cm42)
   if(allocated(N_Cm43)) deallocate(N_Cm43)
   if(allocated(N_Cm44)) deallocate(N_Cm44)
   if(allocated(N_U34_Old)) deallocate(N_U34_Old)
   if(allocated(N_U35_Old)) deallocate(N_U35_Old)
   if(allocated(N_U36_Old)) deallocate(N_U36_Old)
   if(allocated(N_U37_Old)) deallocate(N_U37_Old)
   if(allocated(N_U38_Old)) deallocate(N_U38_Old)
   if(allocated(N_Np37_Old)) deallocate(N_Np37_Old)
   if(allocated(N_Np38_Old)) deallocate(N_Np38_Old)
   if(allocated(N_Np39_Old)) deallocate(N_Np39_Old)
   if(allocated(N_Pu38_Old)) deallocate(N_Pu38_Old)
   if(allocated(N_Pu39_Old)) deallocate(N_Pu39_Old)
   if(allocated(N_Pu40_Old)) deallocate(N_Pu40_Old)
   if(allocated(N_Pu41_Old)) deallocate(N_Pu41_Old)
   if(allocated(N_Pu42_Old)) deallocate(N_Pu42_Old)
   if(allocated(N_Pu43_Old)) deallocate(N_Pu43_Old)
   if(allocated(N_Am41_Old)) deallocate(N_Am41_Old)
   if(allocated(N_As42_Old)) deallocate(N_As42_Old)
   if(allocated(N_Am42_Old)) deallocate(N_Am42_Old)
   if(allocated(N_Am43_Old)) deallocate(N_Am43_Old)
   if(allocated(N_Am44_Old)) deallocate(N_Am44_Old)
   if(allocated(N_Cm42_Old)) deallocate(N_Cm42_Old)
   if(allocated(N_Cm43_Old)) deallocate(N_Cm43_Old)
   if(allocated(N_Cm44_Old)) deallocate(N_Cm44_Old)
   if(allocated(N_U34_Predictor)) deallocate(N_U34_Predictor)
   if(allocated(N_U35_Predictor)) deallocate(N_U35_Predictor)
   if(allocated(N_U36_Predictor)) deallocate(N_U36_Predictor)
   if(allocated(N_U37_Predictor)) deallocate(N_U37_Predictor)
   if(allocated(N_U38_Predictor)) deallocate(N_U38_Predictor)
   if(allocated(N_Np37_Predictor)) deallocate(N_Np37_Predictor)
   if(allocated(N_Np38_Predictor)) deallocate(N_Np38_Predictor)
   if(allocated(N_Np39_Predictor)) deallocate(N_Np39_Predictor)
   if(allocated(N_Pu38_Predictor)) deallocate(N_Pu38_Predictor)
   if(allocated(N_Pu39_Predictor)) deallocate(N_Pu39_Predictor)
   if(allocated(N_Pu40_Predictor)) deallocate(N_Pu40_Predictor)
   if(allocated(N_Pu41_Predictor)) deallocate(N_Pu41_Predictor)
   if(allocated(N_Pu42_Predictor)) deallocate(N_Pu42_Predictor)
   if(allocated(N_Pu43_Predictor)) deallocate(N_Pu43_Predictor)
   if(allocated(N_Am41_Predictor)) deallocate(N_Am41_Predictor)
   if(allocated(N_As42_Predictor)) deallocate(N_As42_Predictor)
   if(allocated(N_Am42_Predictor)) deallocate(N_Am42_Predictor)
   if(allocated(N_Am43_Predictor)) deallocate(N_Am43_Predictor)
   if(allocated(N_Am44_Predictor)) deallocate(N_Am44_Predictor)
   if(allocated(N_Cm42_Predictor)) deallocate(N_Cm42_Predictor)
   if(allocated(N_Cm43_Predictor)) deallocate(N_Cm43_Predictor)
   if(allocated(N_Cm44_Predictor)) deallocate(N_Cm44_Predictor)
   if(allocated(N_I35)) deallocate(N_I35)
   if(allocated(N_Xe35)) deallocate(N_Xe35)
   if(allocated(N_Nd47)) deallocate(N_Nd47)
   if(allocated(N_Nd48)) deallocate(N_Nd48)
   if(allocated(N_Nd49)) deallocate(N_Nd49)
   if(allocated(N_Pm47)) deallocate(N_Pm47)
   if(allocated(N_Ps48)) deallocate(N_Ps48)
   if(allocated(N_Pm48)) deallocate(N_Pm48)
   if(allocated(N_Pm49)) deallocate(N_Pm49)
   if(allocated(N_Sm47)) deallocate(N_Sm47)
   if(allocated(N_Sm48)) deallocate(N_Sm48)
   if(allocated(N_Sm49)) deallocate(N_Sm49)
   if(allocated(N_I35_Old)) deallocate(N_I35_Old)
   if(allocated(N_Xe35_Old)) deallocate(N_Xe35_Old)
   if(allocated(N_Nd47_Old)) deallocate(N_Nd47_Old)
   if(allocated(N_Nd48_Old)) deallocate(N_Nd48_Old)
   if(allocated(N_Nd49_Old)) deallocate(N_Nd49_Old)
   if(allocated(N_Pm47_Old)) deallocate(N_Pm47_Old)
   if(allocated(N_Ps48_Old)) deallocate(N_Ps48_Old)
   if(allocated(N_Pm48_Old)) deallocate(N_Pm48_Old)
   if(allocated(N_Pm49_Old)) deallocate(N_Pm49_Old)
   if(allocated(N_Sm47_Old)) deallocate(N_Sm47_Old)
   if(allocated(N_Sm48_Old)) deallocate(N_Sm48_Old)
   if(allocated(N_Sm49_Old)) deallocate(N_Sm49_Old)
   if(allocated(N_I35_Predictor)) deallocate(N_I35_Predictor)
   if(allocated(N_Xe35_Predictor)) deallocate(N_Xe35_Predictor)
   if(allocated(N_Nd47_Predictor)) deallocate(N_Nd47_Predictor)
   if(allocated(N_Nd48_Predictor)) deallocate(N_Nd48_Predictor)
   if(allocated(N_Nd49_Predictor)) deallocate(N_Nd49_Predictor)
   if(allocated(N_Pm47_Predictor)) deallocate(N_Pm47_Predictor)
   if(allocated(N_Ps48_Predictor)) deallocate(N_Ps48_Predictor)
   if(allocated(N_Pm48_Predictor)) deallocate(N_Pm48_Predictor)
   if(allocated(N_Pm49_Predictor)) deallocate(N_Pm49_Predictor)
   if(allocated(N_Sm47_Predictor)) deallocate(N_Sm47_Predictor)
   if(allocated(N_Sm48_Predictor)) deallocate(N_Sm48_Predictor)
   if(allocated(N_Sm49_Predictor)) deallocate(N_Sm49_Predictor)
   if(allocated(N_Gd52)) deallocate(N_Gd52)
   if(allocated(N_Gd54)) deallocate(N_Gd54)
   if(allocated(N_Gd55)) deallocate(N_Gd55)
   if(allocated(N_Gd56)) deallocate(N_Gd56)
   if(allocated(N_Gd57)) deallocate(N_Gd57)
   if(allocated(N_Gd58)) deallocate(N_Gd58)
   if(allocated(N_Gd60)) deallocate(N_Gd60)
   if(allocated(N_Gd52_Old)) deallocate(N_Gd52_Old)
   if(allocated(N_Gd54_Old)) deallocate(N_Gd54_Old)
   if(allocated(N_Gd55_Old)) deallocate(N_Gd55_Old)
   if(allocated(N_Gd56_Old)) deallocate(N_Gd56_Old)
   if(allocated(N_Gd57_Old)) deallocate(N_Gd57_Old)
   if(allocated(N_Gd58_Old)) deallocate(N_Gd58_Old)
   if(allocated(N_Gd60_Old)) deallocate(N_Gd60_Old)
   if(allocated(N_Gd52_Predictor)) deallocate(N_Gd52_Predictor)
   if(allocated(N_Gd54_Predictor)) deallocate(N_Gd54_Predictor)
   if(allocated(N_Gd55_Predictor)) deallocate(N_Gd55_Predictor)
   if(allocated(N_Gd56_Predictor)) deallocate(N_Gd56_Predictor)
   if(allocated(N_Gd57_Predictor)) deallocate(N_Gd57_Predictor)
   if(allocated(N_Gd58_Predictor)) deallocate(N_Gd58_Predictor)
   if(allocated(N_Gd60_Predictor)) deallocate(N_Gd60_Predictor)
   if(allocated(N_H2O)) deallocate(N_H2O)
   if(allocated(N_B0)) deallocate(N_B0)

   if(allocated(HMMASS)) deallocate(HMMASS)
   if(allocated(DET_N_A1)) deallocate(DET_N_A1)
   if(allocated(DET_N_A2)) deallocate(DET_N_A2)
   if(allocated(DET_N_A3)) deallocate(DET_N_A3)
   if(allocated(DET_N_A4)) deallocate(DET_N_A4)
   if(allocated(DET_N_A2m)) deallocate(DET_N_A2m)
   if(allocated(DET_N_B2)) deallocate(DET_N_B2)
   if(allocated(DET_N_B3)) deallocate(DET_N_B3)
   if(allocated(DET_N_A1_Old)) deallocate(DET_N_A1_Old)
   if(allocated(DET_N_A2_Old)) deallocate(DET_N_A2_Old)
   if(allocated(DET_N_A3_Old)) deallocate(DET_N_A3_Old)
   if(allocated(DET_N_A4_Old)) deallocate(DET_N_A4_Old)
   if(allocated(DET_N_A2m_Old)) deallocate(DET_N_A2m_Old)
   if(allocated(DET_N_B2_Old)) deallocate(DET_N_B2_Old)
   if(allocated(DET_N_B3_Old)) deallocate(DET_N_B3_Old)
   if(allocated(DET_N_V1)) deallocate(DET_N_V1)
   if(allocated(DET_N_V2)) deallocate(DET_N_V2)
   if(allocated(DET_N_Cr52)) deallocate(DET_N_Cr52)
   if(allocated(DET_N_V1_Old)) deallocate(DET_N_V1_Old)
   if(allocated(DET_N_V2_Old)) deallocate(DET_N_V2_Old)
   if(allocated(DET_N_Cr52_Old)) deallocate(DET_N_Cr52_Old)
   if(allocated(DET_I_beta_A2)) deallocate(DET_I_beta_A2)
   if(allocated(DET_I_beta_A2m)) deallocate(DET_I_beta_A2m)
   if(allocated(DET_I_beta_A3)) deallocate(DET_I_beta_A3)
   if(allocated(DET_I_beta_B2)) deallocate(DET_I_beta_B2)
   if(allocated(DET_I_beta_B3)) deallocate(DET_I_beta_B3)
   if(allocated(DET_I_beta_rh)) deallocate(DET_I_beta_rh)
   if(allocated(DET_I_beta_rh_p)) deallocate(DET_I_beta_rh_p)
   if(allocated(DET_I_beta_rh_d)) deallocate(DET_I_beta_rh_d)
   if(allocated(DET_I_beta_V2)) deallocate(DET_I_beta_V2)
   if(allocated(DET_I_beta_si)) deallocate(DET_I_beta_si)
   if(allocated(N_A1)) deallocate(N_A1)
   if(allocated(N_A2)) deallocate(N_A2)
   if(allocated(N_A3)) deallocate(N_A3)
   if(allocated(N_A4)) deallocate(N_A4)
   if(allocated(N_A2m)) deallocate(N_A2m)
   if(allocated(N_B2)) deallocate(N_B2)
   if(allocated(N_B3)) deallocate(N_B3)
   if(allocated(N_A1_Old)) deallocate(N_A1_Old)
   if(allocated(N_A2_Old)) deallocate(N_A2_Old)
   if(allocated(N_A3_Old)) deallocate(N_A3_Old)
   if(allocated(N_A4_Old)) deallocate(N_A4_Old)
   if(allocated(N_A2m_Old)) deallocate(N_A2m_Old)
   if(allocated(N_B2_Old)) deallocate(N_B2_Old)
   if(allocated(N_B3_Old)) deallocate(N_B3_Old)
   if(allocated(N_V1)) deallocate(N_V1)
   if(allocated(N_V2)) deallocate(N_V2)
   if(allocated(N_Cr52)) deallocate(N_Cr52)
   if(allocated(N_V1_Old)) deallocate(N_V1_Old)
   if(allocated(N_V2_Old)) deallocate(N_V2_Old)
   if(allocated(N_Cr52_Old)) deallocate(N_Cr52_Old)
   if(allocated(I_beta_A2)) deallocate(I_beta_A2)
   if(allocated(I_beta_A2m)) deallocate(I_beta_A2m)
   if(allocated(I_beta_A3)) deallocate(I_beta_A3)
   if(allocated(I_beta_B2)) deallocate(I_beta_B2)
   if(allocated(I_beta_B3)) deallocate(I_beta_B3)
   if(allocated(I_beta_rh)) deallocate(I_beta_rh)
   if(allocated(I_beta_rh_p)) deallocate(I_beta_rh_p)
   if(allocated(I_beta_rh_d)) deallocate(I_beta_rh_d)
   if(allocated(I_beta_V2)) deallocate(I_beta_V2)
   if(allocated(I_beta_si)) deallocate(I_beta_si)
   if(allocated(inp_jump_bu)) deallocate(inp_jump_bu)
   if(allocated(jump_bu)) deallocate(jump_bu)
   if(allocated(burned_nden)) deallocate(burned_nden)
   if(allocated(HFF)) deallocate(HFF)
   if(allocated(PinPOW_2D)) deallocate(PinPOW_2D)
   if(allocated(PinQ_2D)) deallocate(PinQ_2D)
   if(allocated(PinBU_2D)) deallocate(PinBU_2D)
   if(allocated(PinPOW_3D)) deallocate(PinPOW_3D)
   if(allocated(PinQ_3D)) deallocate(PinQ_3D)
   if(allocated(PinBU_3D)) deallocate(PinBU_3D)
   if(allocated(PinMTU_2D)) deallocate(PinMTU_2D)
   if(allocated(PinMTU_3D)) deallocate(PinMTU_3D)
   if(allocated(pinpow_3d_old)) deallocate(pinpow_3d_old)
   if(allocated(pinq_3d_old)) deallocate(pinq_3d_old)
   if(allocated(akratio)) deallocate(akratio)
   if(allocated(akappa)) deallocate(akappa)
   if(allocated(amu)) deallocate(amu)
   if(allocated(ar)) deallocate(ar)
   if(allocated(as)) deallocate(as)
   if(allocated(ardet)) deallocate(ardet)
   if(allocated(asnmu)) deallocate(asnmu)
   if(allocated(acnmu)) deallocate(acnmu)
   if(allocated(asnka)) deallocate(asnka)
   if(allocated(acnka)) deallocate(acnka)
   if(allocated(asnmux)) deallocate(asnmux)
   if(allocated(acnmux)) deallocate(acnmux)
   if(allocated(asnkax)) deallocate(asnkax)
   if(allocated(acnkax)) deallocate(acnkax)
   if(allocated(asnmuy)) deallocate(asnmuy)
   if(allocated(acnmuy)) deallocate(acnmuy)
   if(allocated(asnkay)) deallocate(asnkay)
   if(allocated(acnkay)) deallocate(acnkay)
   if(allocated(asnmuz)) deallocate(asnmuz)
   if(allocated(acnmuz)) deallocate(acnmuz)
   if(allocated(asnkaz)) deallocate(asnkaz)
   if(allocated(acnkaz)) deallocate(acnkaz)
   if(allocated(kflag)) deallocate(kflag)
   if(allocated(pploc)) deallocate(pploc)
   if(allocated(nodec)) deallocate(nodec)
   if(allocated(nxcs)) deallocate(nxcs)
   if(allocated(nxce)) deallocate(nxce)
   if(allocated(lctox)) deallocate(lctox)
   if(allocated(lctoy)) deallocate(lctoy)
   if(allocated(nneighc)) deallocate(nneighc)
   if(allocated(lcc)) deallocate(lcc)
   if(allocated(lcn)) deallocate(lcn)
   if(allocated(lcnw)) deallocate(lcnw)
   if(allocated(lcsw)) deallocate(lcsw)
   if(allocated(lcne)) deallocate(lcne)
   if(allocated(lcse)) deallocate(lcse)
   if(allocated(iquad)) deallocate(iquad)
   if(allocated(asnmut)) deallocate(asnmut)
   if(allocated(asnmutl)) deallocate(asnmutl)
   if(allocated(asnmuttl)) deallocate(asnmuttl)
   if(allocated(acnmut)) deallocate(acnmut)
   if(allocated(acnmutl)) deallocate(acnmutl)
   if(allocated(acnmuttl)) deallocate(acnmuttl)
   if(allocated(asnkat)) deallocate(asnkat)
   if(allocated(asnkatl)) deallocate(asnkatl)
   if(allocated(asnkattl)) deallocate(asnkattl)
   if(allocated(acnkat)) deallocate(acnkat)
   if(allocated(acnkatl)) deallocate(acnkatl)
   if(allocated(acnkattl)) deallocate(acnkattl)
   if(allocated(bctka)) deallocate(bctka)
   if(allocated(bctmu)) deallocate(bctmu)
   if(allocated(cc11)) deallocate(cc11)
   if(allocated(cc12)) deallocate(cc12)
   if(allocated(cc21)) deallocate(cc21)
   if(allocated(cc22)) deallocate(cc22)
   if(allocated(cur11)) deallocate(cur11)
   if(allocated(cur12)) deallocate(cur12)
   if(allocated(cur21)) deallocate(cur21)
   if(allocated(cur22)) deallocate(cur22)
   if(allocated(cornfka)) deallocate(cornfka)
   if(allocated(cornfmu)) deallocate(cornfmu)
   if(allocated(cpbsrc)) deallocate(cpbsrc)
   if(allocated(phicorn)) deallocate(phicorn)
   if(allocated(phihom)) deallocate(phihom)
   if(allocated(pppeak)) deallocate(pppeak)
   if(allocated(Peak_X)) deallocate(Peak_X)
   if(allocated(Peak_Y)) deallocate(Peak_Y)
   if(allocated(powvalr)) deallocate(powvalr)
   if(allocated(powval)) deallocate(powval)
   if(allocated(RevNorm)) deallocate(RevNorm)
   if(allocated(pinpitch)) deallocate(pinpitch)
   if(allocated(xoffset)) deallocate(xoffset)
   if(allocated(yoffset)) deallocate(yoffset)
   if(allocated(pinmaps)) deallocate(pinmaps)
   if(allocated(pin_inform)) deallocate(pin_inform)
   if(allocated(LP_MTU)) deallocate(LP_MTU)
   if(allocated(I_LP_1N)) deallocate(I_LP_1N)
   if(allocated(I_FA)) deallocate(I_FA)
   if(allocated(I_RF)) deallocate(I_RF)
   if(allocated(I_FA_1N)) deallocate(I_FA_1N)
   if(allocated(I_FARF_1N)) deallocate(I_FARF_1N)
   if(allocated(I_RF_1N)) deallocate(I_RF_1N)
   if(allocated(ixytoifa)) deallocate(ixytoifa)
   if(allocated(I_Gd_FA)) deallocate(I_Gd_FA)
   if(allocated(AxialComp)) deallocate(AxialComp)
   if(allocated(I_Comp)) deallocate(I_Comp)
   if(allocated(I_FARF_1N_2D)) deallocate(I_FARF_1N_2D)
   if(allocated(I_FARF_1N_3D)) deallocate(I_FARF_1N_3D)
   if(allocated(I_FARF_2D)) deallocate(I_FARF_2D)
   if(allocated(index_LP)) deallocate(index_LP)
   if(allocated(Name_LP)) deallocate(Name_LP)
   if(allocated(Flag_BP)) deallocate(Flag_BP)

   if(allocated(BU_RST)) deallocate(BU_RST)
   if(allocated(Normal_Power_RST)) deallocate(Normal_Power_RST)
   if(allocated(T_Fuel_RST)) deallocate(T_Fuel_RST)
   if(allocated(T_Mod_RST)) deallocate(T_Mod_RST)
   if(allocated(D_Mod_RST)) deallocate(D_Mod_RST)
   if(allocated(Flux_RST)) deallocate(Flux_RST)
   if(allocated(maXS_f_3D_RST)) deallocate(maXS_f_3D_RST)
   if(allocated(N_U34_RST)) deallocate(N_U34_RST)
   if(allocated(N_U35_RST)) deallocate(N_U35_RST)
   if(allocated(N_U36_RST)) deallocate(N_U36_RST)
   if(allocated(N_U37_RST)) deallocate(N_U37_RST)
   if(allocated(N_U38_RST)) deallocate(N_U38_RST)
   if(allocated(N_Np37_RST)) deallocate(N_Np37_RST)
   if(allocated(N_Np38_RST)) deallocate(N_Np38_RST)
   if(allocated(N_Np39_RST)) deallocate(N_Np39_RST)
   if(allocated(N_Pu38_RST)) deallocate(N_Pu38_RST)
   if(allocated(N_Pu39_RST)) deallocate(N_Pu39_RST)
   if(allocated(N_Pu40_RST)) deallocate(N_Pu40_RST)
   if(allocated(N_Pu41_RST)) deallocate(N_Pu41_RST)
   if(allocated(N_Pu42_RST)) deallocate(N_Pu42_RST)
   if(allocated(N_Pu43_RST)) deallocate(N_Pu43_RST)
   if(allocated(N_Am41_RST)) deallocate(N_Am41_RST)
   if(allocated(N_As42_RST)) deallocate(N_As42_RST)
   if(allocated(N_Am42_RST)) deallocate(N_Am42_RST)
   if(allocated(N_Am43_RST)) deallocate(N_Am43_RST)
   if(allocated(N_Am44_RST)) deallocate(N_Am44_RST)
   if(allocated(N_Cm42_RST)) deallocate(N_Cm42_RST)
   if(allocated(N_Cm43_RST)) deallocate(N_Cm43_RST)
   if(allocated(N_Cm44_RST)) deallocate(N_Cm44_RST)
   if(allocated(N_I35_RST)) deallocate(N_I35_RST)
   if(allocated(N_Xe35_RST)) deallocate(N_Xe35_RST)
   if(allocated(N_Nd47_RST)) deallocate(N_Nd47_RST)
   if(allocated(N_Nd48_RST)) deallocate(N_Nd48_RST)
   if(allocated(N_Nd49_RST)) deallocate(N_Nd49_RST)
   if(allocated(N_Pm47_RST)) deallocate(N_Pm47_RST)
   if(allocated(N_Ps48_RST)) deallocate(N_Ps48_RST)
   if(allocated(N_Pm48_RST)) deallocate(N_Pm48_RST)
   if(allocated(N_Pm49_RST)) deallocate(N_Pm49_RST)
   if(allocated(N_Sm47_RST)) deallocate(N_Sm47_RST)
   if(allocated(N_Sm48_RST)) deallocate(N_Sm48_RST)
   if(allocated(N_Sm49_RST)) deallocate(N_Sm49_RST)
   if(allocated(N_Gd52_RST)) deallocate(N_Gd52_RST)
   if(allocated(N_Gd54_RST)) deallocate(N_Gd54_RST)
   if(allocated(N_Gd55_RST)) deallocate(N_Gd55_RST)
   if(allocated(N_Gd56_RST)) deallocate(N_Gd56_RST)
   if(allocated(N_Gd57_RST)) deallocate(N_Gd57_RST)
   if(allocated(N_Gd58_RST)) deallocate(N_Gd58_RST)
   if(allocated(N_Gd60_RST)) deallocate(N_Gd60_RST)
   if(allocated(miXS_a_U34_RST)) deallocate(miXS_a_U34_RST)
   if(allocated(miXS_a_U35_RST)) deallocate(miXS_a_U35_RST)
   if(allocated(miXS_a_U36_RST)) deallocate(miXS_a_U36_RST)
   if(allocated(miXS_a_U37_RST)) deallocate(miXS_a_U37_RST)
   if(allocated(miXS_a_U38_RST)) deallocate(miXS_a_U38_RST)
   if(allocated(miXS_a_Np37_RST)) deallocate(miXS_a_Np37_RST)
   if(allocated(miXS_a_Np38_RST)) deallocate(miXS_a_Np38_RST)
   if(allocated(miXS_a_Np39_RST)) deallocate(miXS_a_Np39_RST)
   if(allocated(miXS_a_Pu38_RST)) deallocate(miXS_a_Pu38_RST)
   if(allocated(miXS_a_Pu39_RST)) deallocate(miXS_a_Pu39_RST)
   if(allocated(miXS_a_Pu40_RST)) deallocate(miXS_a_Pu40_RST)
   if(allocated(miXS_a_Pu41_RST)) deallocate(miXS_a_Pu41_RST)
   if(allocated(miXS_a_Pu42_RST)) deallocate(miXS_a_Pu42_RST)
   if(allocated(miXS_a_Pu43_RST)) deallocate(miXS_a_Pu43_RST)
   if(allocated(miXS_a_Am41_RST)) deallocate(miXS_a_Am41_RST)
   if(allocated(miXS_a_As42_RST)) deallocate(miXS_a_As42_RST)
   if(allocated(miXS_a_Am42_RST)) deallocate(miXS_a_Am42_RST)
   if(allocated(miXS_a_Am43_RST)) deallocate(miXS_a_Am43_RST)
   if(allocated(miXS_a_Am44_RST)) deallocate(miXS_a_Am44_RST)
   if(allocated(miXS_a_Cm42_RST)) deallocate(miXS_a_Cm42_RST)
   if(allocated(miXS_a_Cm43_RST)) deallocate(miXS_a_Cm43_RST)
   if(allocated(miXS_a_Cm44_RST)) deallocate(miXS_a_Cm44_RST)
   if(allocated(miXS_f_U34_RST)) deallocate(miXS_f_U34_RST)
   if(allocated(miXS_f_U35_RST)) deallocate(miXS_f_U35_RST)
   if(allocated(miXS_f_U36_RST)) deallocate(miXS_f_U36_RST)
   if(allocated(miXS_f_U37_RST)) deallocate(miXS_f_U37_RST)
   if(allocated(miXS_f_U38_RST)) deallocate(miXS_f_U38_RST)
   if(allocated(miXS_f_Np37_RST)) deallocate(miXS_f_Np37_RST)
   if(allocated(miXS_f_Np38_RST)) deallocate(miXS_f_Np38_RST)
   if(allocated(miXS_f_Np39_RST)) deallocate(miXS_f_Np39_RST)
   if(allocated(miXS_f_Pu38_RST)) deallocate(miXS_f_Pu38_RST)
   if(allocated(miXS_f_Pu39_RST)) deallocate(miXS_f_Pu39_RST)
   if(allocated(miXS_f_Pu40_RST)) deallocate(miXS_f_Pu40_RST)
   if(allocated(miXS_f_Pu41_RST)) deallocate(miXS_f_Pu41_RST)
   if(allocated(miXS_f_Pu42_RST)) deallocate(miXS_f_Pu42_RST)
   if(allocated(miXS_f_Pu43_RST)) deallocate(miXS_f_Pu43_RST)
   if(allocated(miXS_f_Am41_RST)) deallocate(miXS_f_Am41_RST)
   if(allocated(miXS_f_As42_RST)) deallocate(miXS_f_As42_RST)
   if(allocated(miXS_f_Am42_RST)) deallocate(miXS_f_Am42_RST)
   if(allocated(miXS_f_Am43_RST)) deallocate(miXS_f_Am43_RST)
   if(allocated(miXS_f_Am44_RST)) deallocate(miXS_f_Am44_RST)
   if(allocated(miXS_f_Cm42_RST)) deallocate(miXS_f_Cm42_RST)
   if(allocated(miXS_f_Cm43_RST)) deallocate(miXS_f_Cm43_RST)
   if(allocated(miXS_f_Cm44_RST)) deallocate(miXS_f_Cm44_RST)
   if(allocated(miXS_a_I35_RST)) deallocate(miXS_a_I35_RST)
   if(allocated(miXS_a_Xe35_RST)) deallocate(miXS_a_Xe35_RST)
   if(allocated(miXS_a_Nd47_RST)) deallocate(miXS_a_Nd47_RST)
   if(allocated(miXS_a_Nd48_RST)) deallocate(miXS_a_Nd48_RST)
   if(allocated(miXS_a_Nd49_RST)) deallocate(miXS_a_Nd49_RST)
   if(allocated(miXS_a_Pm47_RST)) deallocate(miXS_a_Pm47_RST)
   if(allocated(miXS_a_Ps48_RST)) deallocate(miXS_a_Ps48_RST)
   if(allocated(miXS_a_Pm48_RST)) deallocate(miXS_a_Pm48_RST)
   if(allocated(miXS_a_Pm49_RST)) deallocate(miXS_a_Pm49_RST)
   if(allocated(miXS_a_Sm47_RST)) deallocate(miXS_a_Sm47_RST)
   if(allocated(miXS_a_Sm48_RST)) deallocate(miXS_a_Sm48_RST)
   if(allocated(miXS_a_Sm49_RST)) deallocate(miXS_a_Sm49_RST)
   if(allocated(miXS_a_Gd52_RST)) deallocate(miXS_a_Gd52_RST)
   if(allocated(miXS_a_Gd54_RST)) deallocate(miXS_a_Gd54_RST)
   if(allocated(miXS_a_Gd55_RST)) deallocate(miXS_a_Gd55_RST)
   if(allocated(miXS_a_Gd56_RST)) deallocate(miXS_a_Gd56_RST)
   if(allocated(miXS_a_Gd57_RST)) deallocate(miXS_a_Gd57_RST)
   if(allocated(miXS_a_Gd58_RST)) deallocate(miXS_a_Gd58_RST)
   if(allocated(miXS_a_Gd60_RST)) deallocate(miXS_a_Gd60_RST)
   if(allocated(Y_I35_RST)) deallocate(Y_I35_RST)
   if(allocated(Y_Xe35_RST)) deallocate(Y_Xe35_RST)
   if(allocated(Y_Nd47_RST)) deallocate(Y_Nd47_RST)
   if(allocated(Y_Nd48_RST)) deallocate(Y_Nd48_RST)
   if(allocated(Y_Nd49_RST)) deallocate(Y_Nd49_RST)
   if(allocated(Y_Pm47_RST)) deallocate(Y_Pm47_RST)
   if(allocated(Y_Ps48_RST)) deallocate(Y_Ps48_RST)
   if(allocated(Y_Pm48_RST)) deallocate(Y_Pm48_RST)
   if(allocated(Y_Pm49_RST)) deallocate(Y_Pm49_RST)
   if(allocated(Y_Sm49_RST)) deallocate(Y_Sm49_RST)
   if(allocated(Y_Pm49_eff_RST)) deallocate(Y_Pm49_eff_RST)
   if(allocated(I_4N_RST)) deallocate(I_4N_RST)
   if(allocated(CR_Bot_RST0)) deallocate(CR_Bot_RST0)
   if(allocated(dTemp)) deallocate(dTemp)
   if(allocated(dCR)) deallocate(dCR)
   if(allocated(T_Fuel_RST0)) deallocate(T_Fuel_RST0)
   if(allocated(T_Mod_RST0)) deallocate(T_Mod_RST0)
   if(allocated(D_Mod_RST0)) deallocate(D_Mod_RST0)
   if(allocated(Type_Branch)) deallocate(Type_Branch)
   if(allocated(cappa)) deallocate(cappa)

   if(allocated(T_Mod_Out)) deallocate(T_Mod_Out)
   if(allocated(LinPOW)) deallocate(LinPOW)
   if(allocated(qchf)) deallocate(qchf)
   if(allocated(qwat)) deallocate(qwat)
   if(allocated(dnbr)) deallocate(dnbr)

   if(allocated(dPPM_MovePPM)) deallocate(dPPM_MovePPM)
   if(allocated(MovePPM_Final)) deallocate(MovePPM_Final)
   if(allocated(v_MovePPM)) deallocate(v_MovePPM)
   if(allocated(T_MovePPM)) deallocate(T_MovePPM)
   if(allocated(N_MovePPM)) deallocate(N_MovePPM)
   if(allocated(L_omega_Surf)) deallocate(L_omega_Surf)
   if(allocated(Q_Surf)) deallocate(Q_Surf)
   if(allocated(Q_Surf_Old)) deallocate(Q_Surf_Old)
   if(allocated(C_d_I)) deallocate(C_d_I)
   if(allocated(C_d_I_Old)) deallocate(C_d_I_Old)
   if(allocated(C_d_I_Surf)) deallocate(C_d_I_Surf)
   if(allocated(C_d_I_Surf_Old)) deallocate(C_d_I_Surf_Old)
   if(allocated(S_0)) deallocate(S_0)
   if(allocated(S_1x)) deallocate(S_1x)
   if(allocated(S_1y)) deallocate(S_1y)
   if(allocated(S_1z)) deallocate(S_1z)
   if(allocated(S_2x)) deallocate(S_2x)
   if(allocated(S_2y)) deallocate(S_2y)
   if(allocated(S_2z)) deallocate(S_2z)
   if(allocated(S_Surf)) deallocate(S_Surf)
   if(allocated(Flux_Surf)) deallocate(Flux_Surf)
   if(allocated(Flux_Surf_Old)) deallocate(Flux_Surf_Old)
   if(allocated(chi_p)) deallocate(chi_p)
   if(allocated(chi_d)) deallocate(chi_d)
   if(allocated(i_chan)) deallocate(i_chan)
   if(allocated(i_chan_fa)) deallocate(i_chan_fa)
   if(allocated(i_chan_fa_4n)) deallocate(i_chan_fa_4n)
   if(allocated(i_chan_rf)) deallocate(i_chan_rf)
   if(allocated(i_chan_4n)) deallocate(i_chan_4n)
   if(allocated(scen_tm)) deallocate(scen_tm)
   if(allocated(scen_p)) deallocate(scen_p)
   if(allocated(bin_time_troc)) deallocate(bin_time_troc)
   if(allocated(bin_cr_troc)) deallocate(bin_cr_troc)
   if(allocated(bin_ppm_troc)) deallocate(bin_ppm_troc)
   if(allocated(bin_tm_troc)) deallocate(bin_tm_troc)
   if(allocated(Dum_Real)) deallocate(Dum_Real)
   if(allocated(Dum_Int)) deallocate(Dum_Int)
   if(allocated(Dum_Char)) deallocate(Dum_Char)
   if(allocated(cdf)) deallocate(cdf)
   if(allocated(BU_Ref)) deallocate(BU_Ref)
   if(allocated(BU_Brch)) deallocate(BU_Brch)
   if(allocated(Var_PPM)) deallocate(Var_PPM)
   if(allocated(Var_TF)) deallocate(Var_TF)
   if(allocated(Var_TM)) deallocate(Var_TM)
   if(allocated(Var_DM)) deallocate(Var_DM)
   if(allocated(BU_Ref_NoBP)) deallocate(BU_Ref_NoBP)
   if(allocated(BU_Brch_NoBP)) deallocate(BU_Brch_NoBP)
   if(allocated(BU_Brch_wBP)) deallocate(BU_Brch_wBP)
   if(allocated(BU_Ref_wBP)) deallocate(BU_Ref_wBP)
   if(allocated(Ini_NumDen)) deallocate(Ini_NumDen)
   if(allocated(W_SP)) deallocate(W_SP)
   if(allocated(Type_Tab)) deallocate(Type_Tab)
   if(allocated(N_BU_Ref_wBP)) deallocate(N_BU_Ref_wBP)
   if(allocated(asym_tab)) deallocate(asym_tab)
   if(allocated(asym2itab)) deallocate(asym2itab)
   if(allocated(asym_rot)) deallocate(asym_rot)
   if(allocated(Type_RegBrch)) deallocate(Type_RegBrch)
   if(allocated(Flag_Reg)) deallocate(Flag_Reg)
   if(allocated(XSset)) deallocate(XSset)
   if(allocated(XSset_Table)) deallocate(XSset_Table)
   if(allocated(XSset_Table_Base)) deallocate(XSset_Table_Base)
   if(allocated(XSset_Node)) deallocate(XSset_Node)
   if(allocated(HFFset)) deallocate(HFFset)
   if(allocated(HFF_Table)) deallocate(HFF_Table)
   if(allocated(HFF_Table_Base)) deallocate(HFF_Table_Base)
   if(allocated(Ref_maXS)) deallocate(Ref_maXS)
   if(allocated(dXS_dPPM)) deallocate(dXS_dPPM)
   if(allocated(dXS_dTF)) deallocate(dXS_dTF)
   if(allocated(dXS_dTM)) deallocate(dXS_dTM)
   if(allocated(dXS_dDM)) deallocate(dXS_dDM)
   if(allocated(dXS_dCR)) deallocate(dXS_dCR)
   if(allocated(Ref_HFF)) deallocate(Ref_HFF)
   if(allocated(dHFF_dPPM)) deallocate(dHFF_dPPM)
   if(allocated(dHFF_dTF)) deallocate(dHFF_dTF)
   if(allocated(dHFF_dTM)) deallocate(dHFF_dTM)
   if(allocated(dHFF_dDM)) deallocate(dHFF_dDM)
   if(allocated(dHFF_dCR)) deallocate(dHFF_dCR)
   if(allocated(ADF_Table)) deallocate(ADF_Table)
   !if(allocated(xs)) deallocate(xs)
   !if(allocated(hff)) deallocate(hff)
   !if(allocated(macro_xs_table)) deallocate(macro_xs_table)
   !if(allocated(MacroXSset)) deallocate(MacroXSset)
   if(allocated(Leakage_Table)) deallocate(Leakage_Table)
   if(allocated(leak_ratio)) deallocate(leak_ratio)
   if(allocated(macxs_b0)) deallocate(macxs_b0)
   if(allocated(W_BU_Ref)) deallocate(W_BU_Ref)
   if(allocated(W_BU_Brch)) deallocate(W_BU_Brch)
   if(allocated(W_SP_1)) deallocate(W_SP_1)
   !js+if(allocated(W_PPM)) deallocate(W_PPM)
   !js+if(allocated(W_TF)) deallocate(W_TF)
   !js+if(allocated(W_TM)) deallocate(W_TM)
   if(allocated(I_BU_Ref)) deallocate(I_BU_Ref)
   if(allocated(I_BU_Brch)) deallocate(I_BU_Brch)

   if(allocated(Normal_Power_Z)) deallocate(Normal_Power_Z)
   if(allocated(T_Fuel_Z)) deallocate(T_Fuel_Z)
   if(allocated(T_Mod_Z)) deallocate(T_Mod_Z)
   if(allocated(D_Mod_Z)) deallocate(D_Mod_Z)
   if(allocated(BU_Z)) deallocate(BU_Z)
   if(allocated(Normal_Power_XY)) deallocate(Normal_Power_XY)
   if(allocated(T_Fuel_XY)) deallocate(T_Fuel_XY)
   if(allocated(T_Mod_XY)) deallocate(T_Mod_XY)
   if(allocated(D_Mod_XY)) deallocate(D_Mod_XY)
   if(allocated(BU_XY)) deallocate(BU_XY)
   if(allocated(Normal_Power_XYZ)) deallocate(Normal_Power_XYZ)
   if(allocated(T_Fuel_XYZ)) deallocate(T_Fuel_XYZ)
   if(allocated(T_Mod_XYZ)) deallocate(T_Mod_XYZ)
   if(allocated(D_Mod_XYZ)) deallocate(D_Mod_XYZ)
   if(allocated(BU_XYZ)) deallocate(BU_XYZ)
   if(allocated(FA_ASI)) deallocate(FA_ASI)
   if(allocated(N_Xe35_XYZ)) deallocate(N_Xe35_XYZ)
   if(allocated(N_Sm49_XYZ)) deallocate(N_Sm49_XYZ)
   if(allocated(FFlux_XYZ)) deallocate(FFlux_XYZ)
   if(allocated(TFlux_XYZ)) deallocate(TFlux_XYZ)
   if(allocated(fFlux_adj_XYZ)) deallocate(fFlux_adj_XYZ)
   if(allocated(tFlux_adj_XYZ)) deallocate(tFlux_adj_XYZ)
   if(allocated(fFlux_adj_XY)) deallocate(fFlux_adj_XY)
   if(allocated(tFlux_adj_XY)) deallocate(tFlux_adj_XY)
   if(allocated(Normal_Power_XY_4N)) deallocate(Normal_Power_XY_4N)
   if(allocated(BU_XY_4N)) deallocate(BU_XY_4N)

#ifdef siarhei_tr_hex   
   if(allocated(Name_CR_FA      ))  deallocate(Name_CR_FA      )
   if(allocated(CR_Comp_Ins     ))  deallocate(CR_Comp_Ins     ) ! record fully inserted composition state
   if(allocated(CR_Comp_Wtr     ))  deallocate(CR_Comp_Wtr     ) ! record fully withdrawn composition state
   if(allocated(CR_Comp_HEX     ))  deallocate(CR_Comp_HEX     ) ! record current CR state (criticality search)
   if(allocated(CR_Comp_HEX_old ))  deallocate(CR_Comp_HEX_old ) ! record previous step CR state
   if(allocated(cumulat_height_z))  deallocate(cumulat_height_z) 
   if(allocated(Name_LP_to_CR   ))  deallocate(Name_LP_to_CR) 
   if(allocated(CR_GridSize_z   ))  deallocate(CR_GridSize_z)    

   if(allocated(D_3D_CR         ))  deallocate(D_3D_CR         )
   if(allocated(maXS_tr_3D_CR   ))  deallocate(maXS_tr_3D_CR   )
   if(allocated(maXS_a_3D_CR    ))  deallocate(maXS_a_3D_CR    )
   if(allocated(maXS_f_3D_CR    ))  deallocate(maXS_f_3D_CR    )
   if(allocated(nu_maXS_f_3D_CR ))  deallocate(nu_maXS_f_3D_CR )
   if(allocated(kap_maXS_f_3D_CR))  deallocate(kap_maXS_f_3D_CR)
   if(allocated(maXS_s_3D_CR    ))  deallocate(maXS_s_3D_CR    )
   if(allocated(maXS_r_3D_CR    ))  deallocate(maXS_r_3D_CR    )
   if(allocated(maXS_chi_3D_CR  ))  deallocate(maXS_chi_3D_CR  )
   if(allocated(maXS_chid_3D_CR ))  deallocate(maXS_chid_3D_CR )
   if(allocated(maXS_scat_3D_CR ))  deallocate(maXS_scat_3D_CR )

   if(allocated(XSset_Hex_CR    ))  deallocate(XSset_Hex_CR    )
   if(allocated(CR_Position     ))  deallocate(CR_Position     )
   if(allocated(CR_Position_old ))  deallocate(CR_Position_old )

   if(allocated(history_of_CR_search ))  deallocate(history_of_CR_search )
   
#endif
   
end subroutine Finalize_All

end module Mod_Finalize
